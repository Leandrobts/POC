
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v430000: The Ambush</title>
<style>
    body { background: #000; color: #ff0; font-family: monospace; text-align: center; padding: 10px; }
    h1 { border-bottom: 2px solid #ff0; color: #fff; }
    .status { 
        border: 2px solid #fff; padding: 15px; margin-bottom: 20px; 
        font-size: 1.2em; background: #550; color: #fff; font-weight: bold;
    }
    
    button {
        display: block; width: 100%; padding: 25px; margin: 15px 0;
        background: #330; color: #fff; border: 2px solid #ff0;
        font-size: 20px; font-weight: bold; cursor: pointer; text-transform: uppercase;
    }
    button:hover { background: #ff0; color: #000; }
    
    #stage { background: #111; height: 50px; border: 1px solid #555; margin-top: 20px; }
</style>
</head>
<body>

<h1>v430000: THE AMBUSH (OPTIONS TRAP)</h1>

<div class="status" id="msg">
    1. CLIQUE NO BOTÃO.<br>
    2. ENTRE EM FULLSCREEN.<br>
    3. APERTE "OPTIONS" PARA ABRIR O MENU.<br>
    (A armadilha dispara ao abrir o menu)
</div>

<button onclick="ambush(a01)">01. Menu Open -> DOM Nuke</button>

<button onclick="ambush(a02)">02. Menu Open -> Pointer Poison</button>

<button onclick="ambush(a03)">03. Menu Open -> CPU Freeze</button>

<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    const Msg = document.getElementById('msg');
    
    // Armazém global
    let arrays = [];

    function ambush(vectorFunc) {
        Stage.innerHTML = "";
        arrays = [];
        
        // 1. Configura
        const target = vectorFunc(Stage);
        
        // 2. Fullscreen
        if (target.webkitRequestFullscreen) target.webkitRequestFullscreen();
        else if (target.requestFullscreen) target.requestFullscreen();

        // 3. ARMADILHA DE FOCO (DETECTA O BOTÃO OPTIONS)
        // Quando o menu do PS4 abre, a janela perde o foco.
        window.onblur = function() {
            Msg.innerText = "⚡ MENU DETECTADO! DETONANDO... ⚡";
            Msg.style.background = "red";
            
            // Executa o ataque IMEDIATAMENTE antes do usuário conseguir clicar em atualizar
            if(target._ambush) {
                // Executamos várias vezes para garantir
                try { target._ambush(); } catch(e){}
            }
        };

        // Fallback: Visibility API (Caso o blur falhe)
        document.onvisibilitychange = function() {
            if (document.hidden && target._ambush) {
                target._ambush();
            }
        };
    }

    // =================================================================
    // 01. Menu Open -> DOM Nuke
    // Quando o menu abre, destruímos todo o HTML.
    // Se o usuário clicar em "Atualizar", o navegador tenta limpar um DOM que não existe.
    // =================================================================
    function a01(stage) {
        const d = document.createElement('div');
        d.innerText = "DOM AMBUSH";
        stage.appendChild(d);

        // Cria estrutura complexa para confundir o renderizador
        const root = document.createElement('div');
        for(let i=0; i<1000; i++) {
            root.appendChild(document.createElement('span'));
        }
        document.body.appendChild(root);

        d._ambush = () => {
            // DESTRUIÇÃO SILENCIOSA
            // Removemos o root, mas mantemos referência em memória
            root.remove();
            
            // Substitui o body inteiro por lixo
            document.body.innerHTML = "<h1>SYSTEM COMPROMISED</h1>";
            
            // Força Garbage Collector implícito criando arrays grandes
            for(let i=0; i<100; i++) arrays.push(new Uint8Array(1024*1024));
        };
        return d;
    }

    // =================================================================
    // 02. Menu Open -> Pointer Poison
    // Usa a técnica de "Fake Object" (v37) mas disparada pelo menu.
    // =================================================================
    function a02(stage) {
        const d = document.createElement('div');
        d.innerText = "POINTER AMBUSH";
        stage.appendChild(d);

        let victim = { id: 1, data: "important" };
        
        // Prepara o veneno (Fake Object)
        const poison = new Float64Array(16);
        poison.fill(1.123456789e-100); // Valor mágico

        d._ambush = () => {
            // Libera o objeto vítima assim que o menu abre
            victim = null;
            
            // Tenta colocar o veneno no lugar dele
            arrays.push(poison);
            
            // Tenta acessar a vítima morta
            // Se o timing for perfeito, acessa o veneno
            try {
                const x = victim.id; 
            } catch(e) {
                // Se falhar (victim é null), forçamos acesso direto à memória
                // criando um loop que o 'Refresh' vai interromper
                const big = new Uint32Array(1024*1024*50); // 200MB alloc
            }
        };
        return d;
    }

    // =================================================================
    // 03. Menu Open -> CPU Freeze
    // Trava o navegador assim que o menu abre.
    // Isso deve fazer o menu ficar lento e o botão 'Atualizar' causar panic.
    // =================================================================
    function a03(stage) {
        const d = document.createElement('div');
        d.innerText = "FREEZE AMBUSH";
        stage.appendChild(d);

        d._ambush = () => {
            // Loop Síncrono Infinito
            // Isso vai travar a UI do navegador embaixo do menu do PS4
            // O sistema vai tentar matar o processo travado ao clicar em Atualizar
            const start = Date.now();
            while(true) {
                // Faz algo útil para aquecer a CPU
                Math.random();
                
                // Tenta alocar memória a cada segundo para pressionar o Kernel
                if (Date.now() - start > 1000) {
                     arrays.push(new Uint8Array(1024));
                }
            }
        };
        return d;
    }

</script>
</body>
</html>
