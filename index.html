
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v70000 (50 Vectors)</title>
</head>
<body>

<h1>SUITE V70000: MAX CAPACITY</h1>
<hr>

<button onclick="t01()">01. SVG Filter Chain Cycle</button>
<button onclick="t02()">02. SVG Use Element Recursion</button>
<button onclick="t03()">03. SVG Marker-End Layout UAF</button>
<button onclick="t04()">04. SVG Pattern Content Mutation</button>
<button onclick="t05()">05. SVG Path d-Attribute Float Overflow</button>
<button onclick="t06()">06. SVG TextPath Detach Race</button>
<button onclick="t07()">07. SVG Mask Recursion Depth</button>
<button onclick="t08()">08. SVG FEColorMatrix Type Confusion</button>
<button onclick="t09()">09. SVG AnimateMotion Path Removal</button>
<button onclick="t10()">10. SVG ForeignObject Layout Thrash</button>
<br>

<button onclick="t11()">11. Canvas Pattern Zero-Size Alloc</button>
<button onclick="t12()">12. Canvas Gradient Stop Removal</button>
<button onclick="t13()">13. Canvas PutImageData OOB Write</button>
<button onclick="t14()">14. Canvas Path2D ArcTo Infinity</button>
<button onclick="t15()">15. Canvas GlobalCompositeOperation State</button>
<button onclick="t16()">16. Canvas ShadowBlur Recursion</button>
<button onclick="t17()">17. Canvas Font Loading Race</button>
<button onclick="t18()">18. Canvas Transform Matrix Singular</button>
<button onclick="t19()">19. Canvas Clip Rule Mutation</button>
<button onclick="t20()">20. Canvas PixelArray Type Confusion</button>
<br>

<button onclick="t21()">21. Range Extract vs SplitText</button>
<button onclick="t22()">22. DOMNodeInserted Event UAF</button>
<button onclick="t23()">23. DOMSubtreeModified Layout Kill</button>
<button onclick="t24()">24. TreeWalker Filter Node Removal</button>
<button onclick="t25()">25. NodeIterator Detach State</button>
<button onclick="t26()">26. Selection Modify vs Remove</button>
<button onclick="t27()">27. Element AdoptNode Doc Cycle</button>
<button onclick="t28()">28. DocumentFragment Loop Insertion</button>
<button onclick="t29()">29. TextNode Normalize memory-merge</button>
<button onclick="t30()">30. Attribute Node SetNamedItem UAF</button>
<br>

<button onclick="t31()">31. XML Parser Entity Expansion</button>
<button onclick="t32()">32. XSLT Transform Self-Modify</button>
<button onclick="t33()">33. XMLSerializer Namespace Pollution</button>
<button onclick="t34()">34. DOMParser HTML in XML Context</button>
<button onclick="t35()">35. XPath Evaluator Iterator Invalid</button>
<button onclick="t36()">36. XSLT Import Recursion</button>
<button onclick="t37()">37. XML Document Implementation UAF</button>
<button onclick="t38()">38. ProcessingInstruction Data Overflow</button>
<button onclick="t39()">39. CDATASection Split Race</button>
<button onclick="t40()">40. Comment Node Append Cycle</button>
<br>

<button onclick="t41()">41. FontFaceSet Loading Delete</button>
<button onclick="t42()">42. WOFF Font Parsing Buffer Overrun</button>
<button onclick="t43()">43. RegExp Compiled Code Cache Flush</button>
<button onclick="t44()">44. JSON Parse Reviver Array Resize</button>
<button onclick="t45()">45. Array Sort Comparator Detach</button>
<button onclick="t46()">46. Object DefineProperty Proxy Loop</button>
<button onclick="t47()">47. Promise Microtask Queue Flood</button>
<button onclick="t48()">48. Error StackTrace Frame Corruption</button>
<button onclick="t49()">49. Function Bind Stack Overflow</button>
<button onclick="t50()">50. Symbol Key Map Iterator Invalid</button>

<script>
// --- SVG SECTION ---
function t01() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const f = document.createElementNS("http://www.w3.org/2000/svg","filter");
    f.id="f1"; s.appendChild(f);
    const fe = document.createElementNS("http://www.w3.org/2000/svg","feGaussianBlur");
    fe.setAttribute("in","SourceGraphic"); f.appendChild(fe);
    document.body.appendChild(s);
    f.setAttribute("filter","url(#f1)"); // Self ref
    setTimeout(()=>s.remove(),10);
}
function t02() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const u = document.createElementNS("http://www.w3.org/2000/svg","use");
    u.id="u1"; u.setAttributeNS("http://www.w3.org/1999/xlink","href","#u1");
    s.appendChild(u); document.body.appendChild(s);
}
function t03() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const m = document.createElementNS("http://www.w3.org/2000/svg","marker");
    const p = document.createElementNS("http://www.w3.org/2000/svg","path");
    p.setAttribute("marker-end","url(#m)");
    s.appendChild(m); s.appendChild(p); document.body.appendChild(s);
    m.remove(); // Layout UAF attempt
}
function t04() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const p = document.createElementNS("http://www.w3.org/2000/svg","pattern");
    s.appendChild(p); document.body.appendChild(s);
    for(let i=0;i<1000;i++) p.appendChild(document.createElement("rect"));
    p.innerHTML="";
}
function t05() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const p = document.createElementNS("http://www.w3.org/2000/svg","path");
    let d = "M0,0";
    for(let i=0;i<10000;i++) d+=" L"+Math.random()+","+Math.random();
    p.setAttribute("d",d); s.appendChild(p); document.body.appendChild(s);
}
function t06() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const t = document.createElementNS("http://www.w3.org/2000/svg","text");
    const tp = document.createElementNS("http://www.w3.org/2000/svg","textPath");
    t.appendChild(tp); s.appendChild(t); document.body.appendChild(s);
    tp.remove(); t.textContent="Crash";
}
function t07() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    let curr = s;
    for(let i=0;i<500;i++){
        const m = document.createElementNS("http://www.w3.org/2000/svg","mask");
        curr.appendChild(m); curr=m;
    }
    document.body.appendChild(s);
}
function t08() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const f = document.createElementNS("http://www.w3.org/2000/svg","filter");
    const fe = document.createElementNS("http://www.w3.org/2000/svg","feColorMatrix");
    fe.setAttribute("type","matrix");
    fe.setAttribute("values","0 ".repeat(20));
    f.appendChild(fe); s.appendChild(f); document.body.appendChild(s);
    fe.setAttribute("type","saturate");
}
function t09() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const c = document.createElementNS("http://www.w3.org/2000/svg","circle");
    const a = document.createElementNS("http://www.w3.org/2000/svg","animateMotion");
    const mpath = document.createElementNS("http://www.w3.org/2000/svg","mpath");
    a.appendChild(mpath); c.appendChild(a); s.appendChild(c); document.body.appendChild(s);
    mpath.remove();
}
function t10() {
    const s = document.createElementNS("http://www.w3.org/2000/svg","svg");
    const fo = document.createElementNS("http://www.w3.org/2000/svg","foreignObject");
    fo.innerHTML = "<body xmlns='http://www.w3.org/1999/xhtml'><video src='x'></video></body>";
    s.appendChild(fo); document.body.appendChild(s);
    fo.setAttribute("width","10"); fo.setAttribute("height","10");
}

// --- CANVAS SECTION ---
function t11() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    const p = ctx.createPattern(c, 'repeat');
    ctx.fillStyle = p; ctx.fillRect(0,0,10,10);
}
function t12() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    const g = ctx.createLinearGradient(0,0,100,100);
    g.addColorStop(0,'red');
    g.addColorStop(1,'blue');
    ctx.fillStyle = g;
    // Attempting to modify used gradient memory
    c.width = 0; 
    ctx.fillRect(0,0,100,100);
}
function t13() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    const img = ctx.createImageData(10,10);
    // Huge buffer write
    const huge = new Uint8ClampedArray(100000);
    try{img.data.set(huge);}catch(e){}
    ctx.putImageData(img, 10000, 10000); // OOB
}
function t14() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    const p = new Path2D();
    p.arcTo(1/0, 1/0, 1/0, 1/0, 1/0);
    ctx.fill(p);
}
function t15() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    for(let i=0;i<100;i++) {
        ctx.globalCompositeOperation = i%2==0 ? 'source-in' : 'destination-atop';
        ctx.fillRect(0,0,50,50);
    }
}
function t16() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    ctx.shadowBlur = 100;
    ctx.shadowColor = 'red';
    // Deep stack of state saves with shadow calc
    for(let i=0;i<1000;i++) ctx.save();
    ctx.fillRect(0,0,10,10);
}
function t17() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    ctx.font = "100px 'BadFont'";
    ctx.fillText("A",0,0);
    document.fonts.add(new FontFace("BadFont", "url(x)"));
}
function t18() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    // Singular matrix (non-invertible)
    ctx.setTransform(0,0,0,0,0,0);
    ctx.beginPath(); ctx.arc(0,0,10,0,6); ctx.stroke();
}
function t19() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    ctx.rect(0,0,100,100); ctx.clip();
    c.width = 50; // Reset state implicitly
    ctx.fillRect(0,0,100,100);
}
function t20() {
    const c = document.createElement('canvas');
    const ctx = c.getContext('2d');
    const id = ctx.getImageData(0,0,1,1);
    // Type confusion attempt with buffer transfer
    const w = new Worker(URL.createObjectURL(new Blob([""],{type:'text/javascript'})));
    w.postMessage(id.data.buffer, [id.data.buffer]);
    ctx.putImageData(id, 0, 0);
}

// --- DOM & RANGE SECTION ---
function t21() {
    const p = document.createElement('p');
    p.appendChild(document.createTextNode("ABCDE"));
    document.body.appendChild(p);
    const r = document.createRange();
    r.setStart(p.firstChild, 1);
    r.setEnd(p.firstChild, 4);
    p.firstChild.splitText(2); // Invalidates range
    r.extractContents();
    p.remove();
}
function t22() {
    const d = document.createElement('div');
    d.addEventListener('DOMNodeInserted', (e) => {
        e.target.remove(); // Remove immediately on insert
        const x = new Array(1000).fill(1);
    });
    document.body.appendChild(d);
    d.appendChild(document.createElement('span'));
    d.remove();
}
function t23() {
    const t = document.createElement('table');
    document.body.appendChild(t);
    t.addEventListener('DOMSubtreeModified', () => {
        t.innerHTML = ""; // Nuke table during layout
    });
    t.insertRow().insertCell();
    t.remove();
}
function t24() {
    const d = document.createElement('div');
    d.innerHTML="<b><i></i></b>";
    const tw = document.createTreeWalker(d, NodeFilter.SHOW_ELEMENT, {
        acceptNode: (n) => { n.remove(); return NodeFilter.FILTER_ACCEPT; }
    });
    tw.nextNode();
}
function t25() {
    const d = document.createElement('div');
    const ni = document.createNodeIterator(d);
    ni.detach(); 
    ni.nextNode(); // Usage after detach
}
function t26() {
    const d = document.createElement('div');
    d.contentEditable=true; d.innerHTML="ABC";
    document.body.appendChild(d);
    const s = window.getSelection();
    s.selectAllChildren(d);
    d.remove();
    s.modify('move','forward','character');
}
function t27() {
    const d1 = document.implementation.createHTMLDocument();
    const d2 = document.implementation.createHTMLDocument();
    const e = d1.createElement('div');
    d1.body.appendChild(e);
    d2.adoptNode(e);
    d1.adoptNode(e); // Cycle adoption
}
function t28() {
    const df = document.createDocumentFragment();
    const d = document.createElement('div');
    df.appendChild(d);
    d.appendChild(df); // Hierarchy Request Error / Recursion
}
function t29() {
    const d = document.createElement('div');
    for(let i=0;i<1000;i++) d.appendChild(document.createTextNode("a"));
    document.body.appendChild(d);
    d.normalize(); // Merge 1000 nodes into 1
    d.remove();
}
function t30() {
    const d = document.createElement('div');
    const a = document.createAttribute('test');
    d.setAttributeNode(a);
    d.removeAttributeNode(a);
    d.setAttributeNode(a); // Re-attach
}

// --- XML & XSLT SECTION ---
function t31() {
    const parser = new DOMParser();
    const xml = `<!DOCTYPE doc [<!ENTITY x "foo"><!ENTITY y "&x;&x;">]><doc>&y;</doc>`;
    parser.parseFromString(xml, "text/xml");
}
function t32() {
    const xslt = `<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:template match="/"><xsl:apply-templates select="document('')"/></xsl:template></xsl:stylesheet>`;
    const p = new DOMParser();
    const x = p.parseFromString(xslt,"text/xml");
    const proc = new XSLTProcessor();
    proc.importStylesheet(x);
    proc.transformToFragment(x, document);
}
function t33() {
    const xs = new XMLSerializer();
    const d = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    d.setAttributeNS("http://www.w3.org/2000/xmlns/", "xmlns:x", "y");
    xs.serializeToString(d);
}

function t35() {
    const r = document.evaluate("//*", document.body, null, XPathResult.UNORDERED_NODE_ITERATOR_TYPE, null);
    r.iterateNext();
    document.body.innerHTML=""; // Invalidate iterator
    r.iterateNext();
}
function t36() {
    // Requires external file usually, attempting inline data URI import
    const x = `<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform"><xsl:import href="#id"/></xsl:stylesheet>`;
    const p = new DOMParser();
    p.parseFromString(x,"text/xml");
}
function t37() {
    const doc = document.implementation.createDocument(null,null,null);
    const r = doc.createElement('root');
    doc.appendChild(r);
    r.remove();
    doc.appendChild(r);
}
function t38() {
    const pi = document.createProcessingInstruction("target", "data".repeat(10000));
}
function t39() {
    const xml = document.implementation.createDocument(null,"r",null);
    const c = xml.createCDATASection("Test");
    c.splitText(2);
}
function t40() {
    const c = document.createComment("test");
    try { c.appendChild(document.createTextNode("x")); } catch(e){}
}

// --- ESOTERIC SECTION ---
function t41() {
    const f = new FontFace("X", "url(x)");
    document.fonts.add(f);
    document.fonts.delete(f);
    f.load();
}
function t42() {
    // Malformed WOFF header simulation (needs binary, mocked here with garbage)
    const f = new FontFace("Crash", "url(data:application/font-woff;base64,AAA)");
    f.load();
}
function t43() {
    const r = /./;
    for(let i=0;i<1000;i++) r.exec("a");
    r.compile("b"); // Deprecated but might trigger flush
}
function t44() {
    const json = '[1,2,3]';
    JSON.parse(json, (k,v)=>{
        if(k==="1") return undefined; // Remove item during parse
        return v;
    });
}
function t45() {
    const a = [1,2,3];
    a.sort(()=>{
        a.length=0; // Nuke array during sort
        return 0;
    });
}
function t46() {
    const o = {};
    const p = new Proxy(o, {
        get: (t,k,r) => r[k] // Infinite recursion on get
    });
    try { return p.x; } catch(e){}
}
function t47() {
    function f(){ Promise.resolve().then(f); }
    f(); // Microtask flood
}
function t48() {
    try { throw new Error(); } catch(e) {
        e.stack; // Access stack trace generation
    }
}
function t49() {
    function f(){};
    let b = f;
    for(let i=0;i<10000;i++) b = b.bind(null);
    b();
}
function t50() {
    const m = new Map();
    const s = Symbol();
    m.set(s, 1);
    const iter = m.keys();
    iter.next();
    m.delete(s);
    iter.next();
}
</script>
</body>
</html>
