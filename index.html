<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 Precision Thread Stepper</title>
    <style>
        body { 
            background-color: #000; 
            color: #0f0; 
            font-family: 'Courier New', monospace; 
            text-align: center; 
            padding: 20px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            height: 90vh;
        }
        h1 { margin: 0; font-size: 2em; color: #fff; }
        #counter { 
            font-size: 8em; 
            font-weight: bold; 
            margin: 20px 0; 
            color: #0ff; 
            text-shadow: 0 0 20px #0ff;
        }
        #status { font-size: 1.5em; color: #888; margin-bottom: 20px; }
        #timer { font-size: 3em; color: #ff0; font-weight: bold; height: 1.2em;}
        
        .log-box {
            font-size: 0.9em;
            color: #555;
            margin-top: 20px;
        }
    </style>
</head>
<body>

    <h1>STEP-BY-STEP KERNEL FILLER</h1>
    
    <div id="status">INICIANDO EM 3 SEGUNDOS...</div>
    <div id="counter">0</div>
    <div id="timer"></div>
    
    <div class="log-box">Alvo Inicial: 400 | Passo: +2 | Pausa: 10s</div>

    <script>
        // CONFIGURAÇÃO
        const SAFE_BASE = 400;     // Chega aqui rápido
        const STEP_SIZE = 2;       // Adiciona X workers por vez
        const STEP_PAUSE = 10;     // Segundos de pausa

        let workers = [];
        // Worker Super Leve (Low Memory footprint)
        const blob = new Blob(["setInterval(()=>{}, 100000)"], {type:'text/javascript'});
        const url = URL.createObjectURL(blob);

        function updateDisplay() {
            document.getElementById('counter').innerText = workers.length;
        }

        // FASE 1: Enchimento Rápido até 400
        function fastFill() {
            document.getElementById('status').innerText = "FASE 1: Enchimento Rápido...";
            
            let i = setInterval(() => {
                // Cria em lotes de 5 para ser rápido
                for(let k=0; k<5; k++) {
                    if (workers.length < SAFE_BASE) {
                        try {
                            workers.push(new Worker(url));
                        } catch(e) {
                            // Se falhar antes de 400, é OOM (RAM), não Kernel Panic
                            document.getElementById('status').innerText = "ERRO DE RAM (OOM) PREMATURO";
                            clearInterval(i);
                            return;
                        }
                    } else {
                        clearInterval(i);
                        updateDisplay();
                        startSlowClimb(); // Inicia a fase lenta
                        return;
                    }
                }
                updateDisplay();
            }, 20);
        }

        // FASE 2: Escalada Lenta com Pausa
        function startSlowClimb() {
            document.getElementById('status').innerText = "FASE 2: Estabilizando Memória...";
            
            // Adiciona workers
            addStep();
        }

        function addStep() {
            // Tenta adicionar +2 Workers
            try {
                for(let i=0; i<STEP_SIZE; i++) {
                    workers.push(new Worker(url));
                }
                updateDisplay();
                
                // Inicia contagem regressiva para o próximo passo
                startCountdown(STEP_PAUSE);
                
            } catch(e) {
                document.getElementById('status').innerText = "LIMITE ATINGIDO (Erro JS)!";
                document.getElementById('status').style.color = "#f00";
                // Se der erro de JS, tenta forçar mais um pouco
                setTimeout(addStep, 1000); 
            }
        }

        function startCountdown(seconds) {
            let left = seconds;
            document.getElementById('status').innerText = `Estabilizando Kernel...`;
            document.getElementById('timer').innerText = `AGUARDE: ${left}s`;
            
            const timerInterval = setInterval(() => {
                left--;
                if(left > 0) {
                    document.getElementById('timer').innerText = `AGUARDE: ${left}s`;
                } else {
                    clearInterval(timerInterval);
                    document.getElementById('timer').innerText = ">>> INCREMENTANDO <<<";
                    // Chama o próximo passo
                    setTimeout(addStep, 500);
                }
            }, 1000);
        }

        // Início
        setTimeout(fastFill, 3000);

    </script>
</body>
</html>
