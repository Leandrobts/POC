<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Webkit Byte Fuzzer (0x00 - 0xFF) 44</title>
    <style>
        body { background-color: #121212; color: #00FF00; font-family: 'Courier New', monospace; padding: 20px; }
        h1 { border-bottom: 1px solid #333; padding-bottom: 10px; }
        .status-box { border: 1px solid #444; padding: 15px; margin-bottom: 20px; background: #1e1e1e; font-size: 1.2em; }
        .log-box { height: 300px; overflow-y: scroll; border: 1px solid #333; padding: 10px; font-size: 0.9em; color: #ccc; }
        #current-char { color: #FFD700; font-weight: bold; }
        button { padding: 10px 20px; background: #333; color: white; border: none; cursor: pointer; font-size: 1em; }
        button:hover { background: #555; }
        /* Área de teste invisível para não poluir visualmente, mas afetar o DOM */
        #test-area { display: none; }
    </style>
</head>
<body>

    <h1>Fuzzer Sequencial (0x00 - 0xFF)</h1>
    
    <div class="status-box">
        Status: <span id="status-text">Pronto</span><br>
        Testando Byte: <span id="current-char">--</span>
    </div>

    <button onclick="startFuzzing()">INICIAR FUZZING</button>
    <button onclick="stopFuzzing()">PARAR</button>

    <h3>Log de Execução:</h3>
    <div class="log-box" id="console-log"></div>

    <div id="test-area"></div>

    <script>
        let isRunning = false;
        const testArea = document.getElementById('test-area');
        const statusText = document.getElementById('status-text');
        const charDisplay = document.getElementById('current-char');
        const logBox = document.getElementById('console-log');

        function log(msg) {
            const div = document.createElement('div');
            div.textContent = `> ${msg}`;
            logBox.appendChild(div);
            logBox.scrollTop = logBox.scrollHeight; // Auto-scroll
        }

        function sleep(ms) {
            return new Promise(resolve => setTimeout(resolve, ms));
        }

        function stopFuzzing() {
            isRunning = false;
            statusText.textContent = "Parado pelo usuário.";
            statusText.style.color = "red";
        }

        async function startFuzzing() {
            if (isRunning) return;
            isRunning = true;
            statusText.textContent = "Rodando...";
            statusText.style.color = "#00FF00";
            log("Iniciando bateria de testes...");

            // Loop de 0 a 255 (0xFF)
            for (let i = 0; i <= 255; i++) {
                if (!isRunning) break;

                let hex = i.toString(16).toUpperCase().padStart(2, '0');
                let char = String.fromCharCode(i);
                
                // Atualiza a interface ANTES de executar o teste perigoso
                charDisplay.textContent = `0x${hex}`;
                
                try {
                    // --- PREPARAÇÃO DO PAYLOAD ---
                    // Cria uma string massiva para forçar buffer
                    let paddingA = "A".repeat(1000);
                    let paddingB = "B".repeat(1000);
                    
                    // Variação 1: Sanduíche (Padding + Char + Padding)
                    let payload1 = paddingA + char + paddingB;
                    
                    // Variação 2: Repetição do caractere ruim (Buffer Overflow focado)
                    let payload2 = char.repeat(2000);

                    // --- VETOR DE ATAQUE 1: DOM Injection ---
                    testArea.innerHTML = payload1;
                    
                    // --- VETOR DE ATAQUE 2: Manipulação de Título (Comum em exploits) ---
                    document.title = payload2; // Descomente se quiser testar (pode bugar a aba)

                    // --- VETOR DE ATAQUE 3: History State (Causa memory leaks em WebKits antigos) ---
                     history.pushState({}, payload1, "?" + i); 

                } catch (e) {
                    log(`ERRO tratado em 0x${hex}: ${e.message}`);
                }

                // Limpeza para evitar falso positivo por acúmulo de memória
                testArea.innerHTML = "";

                // Pequena pausa para permitir que a UI atualize e o browser "respire"
                // Se crashar, a tela vai congelar mostrando o último Hex testado.
                await sleep(200); 
            }

            if (isRunning) {
                statusText.textContent = "Finalizado. Nenhuma falha crítica detectada.";
                log("Teste concluído com sucesso.");
                isRunning = false;
            }
        }
    </script>
</body>
</html>



