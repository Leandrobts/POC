<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PS4 Thread Walker</title>
    <style>
        body { background-color: #000; color: #0f0; font-family: monospace; padding: 20px; text-align: center; }
        #counter { font-size: 120px; margin-top: 50px; font-weight: bold; }
        #status { font-size: 24px; color: #aaa; margin-top: 20px; }
        button { font-size: 24px; padding: 15px 30px; margin-top: 30px; cursor: pointer; background: #333; color: #fff; border: 2px solid #0f0; }
    </style>
</head>
<body>

    <div id="status">Pronto para iniciar.</div>
    <div id="counter">0</div>
    <button onclick="startWalker()">INICIAR WALKER</button>

    <script>
        // CONFIGURAÇÕES
        const FAST_LIMIT = 350;    // Vai rápido até aqui
        const SLOW_DELAY = 1000;   // 1 segundo entre threads na zona de perigo

        let count = 0;
        const workerCode = `
            function deep(n) {
                const v = new Float64Array(128);
                if (n > 0) deep(n-1);
            }
            deep(10); 
            postMessage("Done");
        `;
        const url = URL.createObjectURL(new Blob([workerCode], {type:"text/javascript"}));

        function updateDisplay() {
            document.getElementById('counter').innerText = count;
        }

        function spawnThread() {
            new Worker(url).onmessage = () => {};
            count++;
            updateDisplay();
        }

        function startWalker() {
            document.getElementById('status').innerText = "Enchendo até " + FAST_LIMIT + "...";
            
            // FASE 1: Enchimento Rápido
            let fastInterval = setInterval(() => {
                // Cria em lotes de 5 para ser rápido mas não instantâneo
                for(let i=0; i<5; i++) spawnThread();

                if(count >= FAST_LIMIT) {
                    clearInterval(fastInterval);
                    startSlowPhase();
                }
            }, 50);
        }

        function startSlowPhase() {
            document.getElementById('status').innerText = "ZONA DE PERIGO: Adicionando 1 por 1...";
            document.body.style.backgroundColor = "#300"; // Fundo vermelho escuro para alertar

            // FASE 2: Caminhada Lenta
            setInterval(() => {
                spawnThread();
                // Feedback visual de pulso a cada thread criada
                document.getElementById('counter').style.color = "#fff";
                setTimeout(() => { document.getElementById('counter').style.color = "#0f0"; }, 100);
            }, SLOW_DELAY);
        }
    </script>
</body>
</html>
