
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v400000: Manual Override</title>
<style>
    body { background: #000; color: #0f0; font-family: monospace; text-align: center; padding: 10px; }
    h1 { border-bottom: 2px solid #0f0; color: #fff; }
    .status { 
        border: 2px solid #fff; padding: 15px; margin-bottom: 20px; 
        font-size: 1.2em; background: #020; color: #fff; font-weight: bold;
    }
    .blink { animation: b 0.1s infinite; }
    @keyframes b { 0% { opacity: 1; } 50% { opacity: 0; } }
    
    button {
        display: block; width: 100%; padding: 25px; margin: 15px 0;
        background: #040; color: #fff; border: 2px solid #0f0;
        font-size: 20px; font-weight: bold; cursor: pointer; text-transform: uppercase;
    }
    button:hover { background: #0f0; color: #000; }
    
    #stage { background: #111; height: 50px; border: 1px solid #555; margin-top: 20px; }
</style>
</head>
<body>

<h1>v400000: MANUAL OVERRIDE</h1>

<div class="status" id="status-box">
    INSTRUÇÃO CRÍTICA:<br>
    1. CLIQUE NO BOTÃO.<br>
    2. ENTRE EM FULLSCREEN (QUADRADO).<br>
    3. FECHE O ALERTA.<br>
    4. ⚠️ QUANDO A TELA PISCAR/TRAVAR: APERTE "ATUALIZAR" (REFRESH) NO CONTROLE MANUALMENTE! ⚠️
</div>

<button onclick="manual_trap(m01)">01. Buffer Sieve (Interrupt Trap)</button>

<button onclick="manual_trap(m02)">02. GPU Texture Lock (Interrupt Trap)</button>

<button onclick="manual_trap(m03)">03. DOM Node Swap (Interrupt Trap)</button>

<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    const Status = document.getElementById('status-box');
    
    // Armazém global
    const memory = []; 

    // =================================================================
    // EXECUTOR MANUAL
    // =================================================================
    function manual_trap(vectorFunc) {
        Stage.innerHTML = "";
        memory.length = 0;
        
        // 1. Prepara o Alvo
        const target = vectorFunc(Stage);
        
        // 2. Fullscreen
        if (target.webkitRequestFullscreen) target.webkitRequestFullscreen();
        else if (target.requestFullscreen) target.requestFullscreen();

        // 3. Timing
        requestAnimationFrame(() => {
            setTimeout(() => {
                // ALERTA DE PREPARAÇÃO
                window.alert("⚠️ MODO DE ESPERA ⚠️\n\n1. Feche este alerta.\n2. Espere a tela piscar ou ficar preta.\n3. APERTE ATUALIZAR/REFRESH MANUALMENTE!");

                // Muda status visual para indicar atividade
                Status.innerText = ">>> APERTE ATUALIZAR AGORA!!! <<<";
                Status.classList.add("blink");
                Status.style.background = "red";

                // A. INICIA O LOOP DE CORRUPÇÃO (Mantém a memória instável)
                if(target._loop) {
                    function loop() {
                        target._loop();
                        requestAnimationFrame(loop);
                    }
                    loop();
                }

                // B. A ARMADILHA DE SAÍDA (O Golpe Final)
                // Isso roda EXATAMENTE quando você aperta "Atualizar"
                window.onbeforeunload = function() {
                    if(target._interrupt) {
                        // Roda código destrutivo no meio do processo de desligamento
                        for(let i=0; i<1000; i++) target._interrupt(); 
                    }
                    // Tenta travar o descarregamento por um instante
                    return "Crash?";
                };
                
            }, 50);
        });
    }

    // =================================================================
    // 01. Buffer Sieve (RAM Fragmentation)
    // O mesmo teste que deu Softlock, mas agora preparado para o Refresh.
    // =================================================================
    function m01(stage) {
        const d = document.createElement('div');
        d.innerText = "RAM TRAP";
        stage.appendChild(d);

        // Preenchimento inicial
        const blocks = [];
        const blockSize = 1024 * 256; 
        for(let i=0; i<300; i++) {
            blocks.push(new Uint32Array(blockSize).fill(0xAAAAAAAA));
        }

        d._loop = () => {
            // Mantém a memória "viva" e fragmentada
            // Aloca e libera ciclicamente para estressar o Kernel
            const idx = Math.floor(Math.random() * blocks.length);
            if(blocks[idx]) {
                blocks[idx] = null; // Libera
            } else {
                try {
                    blocks[idx] = new Uint32Array(blockSize).fill(0xBBBBBBBB); // Realoca
                } catch(e) {}
            }
            
            // Visual feedback (Tela Preta/Branca piscando)
            document.body.style.backgroundColor = (Math.random() > 0.5) ? 'black' : '#111';
        };

        d._interrupt = () => {
            // EXECUTA AO APERTAR REFRESH
            // Tenta criar uma referência circular massiva no momento da morte
            const capture = blocks; 
            blocks.push(capture); 
        };
        return d;
    }

    // =================================================================
    // 02. GPU Texture Lock (Interrupt Trap)
    // Cria texturas na GPU e tenta acessá-las enquanto o navegador fecha.
    // =================================================================
    function m02(stage) {
        const d = document.createElement('div');
        d.innerText = "GPU TRAP";
        stage.appendChild(d);

        const canvases = [];
        for(let i=0; i<20; i++) {
            const c = document.createElement('canvas');
            c.width = 512; c.height = 512;
            document.body.appendChild(c);
            canvases.push(c);
        }

        d._loop = () => {
            // Desenha ruído aleatório para manter a GPU ocupada
            for(let i=0; i<canvases.length; i++) {
                if(Math.random() > 0.8) {
                    const ctx = canvases[i].getContext('2d');
                    ctx.fillStyle = 'red';
                    ctx.fillRect(Math.random()*500, Math.random()*500, 50, 50);
                }
            }
        };

        d._interrupt = () => {
            // EXECUTA AO APERTAR REFRESH
            // Redimensiona todos os canvas para 0 (Destruição VRAM)
            // Enquanto o navegador ainda está tentando desenhar a tela de saída
            for(let i=0; i<canvases.length; i++) {
                canvases[i].width = 0;
                canvases[i].height = 0;
            }
        };
        return d;
    }

    // =================================================================
    // 03. DOM Node Swap (Interrupt Trap)
    // Troca elementos na árvore DOM furiosamente.
    // O Refresh tenta ler a árvore para limpar -> UAF.
    // =================================================================
    function m03(stage) {
        const d = document.createElement('div');
        d.innerText = "DOM TRAP";
        stage.appendChild(d);

        const parent = document.createElement('div');
        document.body.appendChild(parent);
        
        const childA = document.createElement('span'); childA.textContent = "A";
        const childB = document.createElement('span'); childB.textContent = "B";
        
        d._loop = () => {
            // Troca A por B e B por A infinitamente
            try {
                parent.appendChild(childA);
                parent.removeChild(childA);
                parent.appendChild(childB);
                parent.removeChild(childB);
            } catch(e){}
        };

        d._interrupt = () => {
            // EXECUTA AO APERTAR REFRESH
            // Remove o pai. Os filhos ficam órfãos mas o loop (se ainda rodar um ciclo)
            // tenta acessá-los.
            parent.remove();
            document.body.innerHTML = "DEAD";
        };
        return d;
    }

</script>
</body>
</html>
