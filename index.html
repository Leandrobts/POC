<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>PS4 WebKit Stable Crash Suite – Dec 2025 Fix</title>
<style>
  body { font-family: monospace; background:#000; color:#0f0; padding:20px; }
  button { margin:5px; padding:12px; font-size:18px; width:100%; background:#333; color:#0f0; border:1px solid #0f0; }
  #log { white-space:pre-wrap; background:#111; padding:15px; height:300px; overflow-y:scroll; font-size:12px; }
</style>
</head>
<body>

<h1>PS4 WebKit Crash Suite – Fixed & Vanilla (Runs on 9.00-12.02)</h1>
<p>Vetores baseados em PSFree + UAF públicos. Sem JS fancy, só o que o Orbis engole.</p>

<button onclick="test1()">1. ArrayBuffer OOM Flood (Heap Exhaustion)</button>
<button onclick="test2()">2. RegExp Catastrophic Backtracking (JSC Freeze)</button>
<button onclick="test3()">3. DOM Creation Loop (Memory Leak → Crash)</button>
<button onclick="test4()">4. Canvas Pixel Flood (GPU OOM)</button>
<button onclick="test5()">5. SVG Path Recursion (Render Crash)</button>
<button onclick="runAll()">RUN ALL (Expect blue screen or reboot)</button>

<div id="log"></div>

<script>
const logEl = document.getElementById('log');
function log(msg) { logEl.innerText += msg + '\n'; logEl.scrollTop = logEl.scrollHeight; }

function test1() {
    log("[1] ArrayBuffer OOM Flood...");
    try {
        let total = 0;
        while (total < 1e9) {  // PS4 userland ~512MB limit
            const buf = new ArrayBuffer(1024 * 1024);  // 1MB chunks
            new Uint8Array(buf).fill(0x41);
            total += buf.byteLength;
        }
        log("Survived? Unlikely.");
    } catch(e) { log("OOM hit: " + e.message); }
}

function test2() {
    log("[2] RegExp Backtracking Freeze...");
    const evilRe = /^(a+)+b$/;  // Classic catastrophic
    let str = 'a'.repeat(10000) + 'b';
    try {
        for (let i = 0; i < 50; i++) {  // Exponential time
            str.match(evilRe);
        }
        log("No freeze? Rerun.");
    } catch(e) { log("JSC panicked: " + e.message); }
}

function test3() {
    log("[3] DOM Creation Loop...");
    const root = document.createElement('div');
    document.body.appendChild(root);
    try {
        for (let i = 0; i < 50000; i++) {  // DOM tree explosion
            const child = document.createElement('span');
            child.innerHTML = '&nbsp;'.repeat(100);
            root.appendChild(child);
        }
        // Force reflow
        root.offsetHeight;
        log("DOM bloated – wait for leak crash.");
    } catch(e) { log("DOM limit: " + e.message); }
}

function test4() {
    log("[4] Canvas Pixel Flood...");
    const canvas = document.createElement('canvas');
    canvas.width = 4096; canvas.height = 4096;  // Huge for Orbis GPU
    const ctx = canvas.getContext('2d');
    document.body.appendChild(canvas);
    try {
        const imgData = ctx.createImageData(4096, 4096);
        imgData.data.fill(0xFF);  // 64MB+ alloc
        ctx.putImageData(imgData, 0, 0);
        log("GPU should choke now.");
    } catch(e) { log("Canvas OOM: " + e.message); }
}

function test5() {
    log("[5] SVG Path Recursion...");
    const svg = document.createElementNS("http://www.w3.org/2000/svg", "svg");
    svg.setAttribute("width", "100"); svg.setAttribute("height", "100");
    let pathD = "M0 0 ";
    for (let i = 0; i < 2000; i++) {  // Recursive path commands
        pathD += `L${i%100} ${i%100} `;
    }
    const path = document.createElementNS("http://www.w3.org/2000/svg", "path");
    path.setAttribute("d", pathD);
    svg.appendChild(path);
    document.body.appendChild(svg);
    // Force render
    svg.getBBox();
    log("RenderLayer recursion incoming.");
}

function runAll() {
    log("=== RUNNING ALL – HOLD ONTO YOUR PS4 ===");
    test1(); test2(); test3(); test4(); test5();
}

</script>
</body>
</html>
