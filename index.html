<!DOCTYPE html>
<html>
<head>
    <title>PS4 Fuzzer (FAST MODE)</title>
    <style>
        body { background-color: #000; color: #0f0; font-family: monospace; padding: 20px; font-size: 24px; }
        .box { border: 2px solid #444; padding: 20px; margin-bottom: 20px; }
        button { font-size: 24px; padding: 15px; cursor: pointer; background: #222; color: #fff; width: 100%; margin-bottom: 10px;}
        .danger { color: #ff5555; font-weight: bold; font-size: 30px; }
        .highlight { color: yellow; }
    </style>
</head>
<body>

    <h3>PS4 Fuzzer - Modo Rápido</h3>

    <div class="box">
        <div>Tamanho Atual: <span id="current-display" class="highlight">---</span></div>
        <div id="log">Pronto.</div>
    </div>

    <div class="box" style="border-color: red;">
        <strong>ÚLTIMO REGISTRO (CRASH):</strong><br>
        <span id="last-attempt" class="danger">Nenhum</span>
    </div>

    <button onclick="startFuzz()">INICIAR (Pulos de 10KB)</button>
    <button onclick="resetData()">RESETAR TUDO</button>

    <script>
        // --- CONFIGURAÇÕES DE VELOCIDADE ---
        
        // Começa com 4KB (tamanho de uma página de memória padrão)
        const START_SIZE = 4096; 
        
        // Aumenta 10KB por rodada (10240 bytes)
        // Se quiser MUITO rápido, mude para 50000 (50KB)
        const STEP_SIZE = 50000; 
        
        const DELAY_MS = 1000; // 1 segundo entre testes
        const ORIGINAL_URL = window.location.href.split('?')[0].split('#')[0];

        // Elementos
        const logEl = document.getElementById('log');
        const currDisplay = document.getElementById('current-display');
        const lastEl = document.getElementById('last-attempt');

        // Dados
        let currentSize = parseInt(localStorage.getItem('fuzz_size')) || START_SIZE;
        let lastCrash = localStorage.getItem('fuzz_last_crash');
        let isRunning = localStorage.getItem('fuzz_active') === 'true';

        if (lastCrash) {
            lastEl.innerText = lastCrash + " bytes";
            lastEl.innerHTML += "<br><small>(O crash ocorreu tentando este valor)</small>";
        }

        currDisplay.innerText = currentSize + " bytes";

        if (isRunning) {
            runTest();
        }

        function startFuzz() {
            localStorage.setItem('fuzz_active', 'true');
            window.location.href = ORIGINAL_URL;
        }

        function resetData() {
            localStorage.clear();
            location.reload();
        }

        function runTest() {
            // 1. Salva o tamanho que VAI ser testado agora (Suspeito)
            localStorage.setItem('fuzz_last_crash', currentSize);
            
            // 2. Prepara o valor para a PRÓXIMA rodada (caso sobreviva)
            localStorage.setItem('fuzz_size', currentSize + STEP_SIZE);

            logEl.innerText = "Injetando " + currentSize + " bytes...";

            window.fuzzTimer = setTimeout(() => {
                try {
                    const payload = "/" + "A".repeat(currentSize);

                    // TENTA QUEBRAR
                    history.pushState({}, "crash", payload);
                    
                    // SE SOBREVIVEU:
                    history.replaceState({}, "clean", "clean"); 
                    window.location.href = ORIGINAL_URL;

                } catch (e) {
                    console.log(e);
                    // Erro de JS não é crash de Kernel. Continua.
                    window.location.href = ORIGINAL_URL;
                }
            }, DELAY_MS);
        }
    </script>
</body>
</html>
